<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Selective Disclosure for JWTs (SD-JWT)</title>
<meta content="Daniel Fett" name="author">
<meta content="Kristina Yasuda" name="author">
<meta content="
       This document specifies conventions for creating JSON Web Token (JWT)
documents that support selective disclosure of JWT claim values. 
    " name="description">
<meta content="xml2rfc 2.40.1" name="generator">
<meta content="security" name="keyword">
<meta content="oauth2" name="keyword">
<meta content="draft-ietf-oauth-selective-disclosure-jwt-00" name="ietf.draft">
<link href="./draft-ietf-oauth-selective-disclosure-jwt-00.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Avoid wrapping of URLs in references */
@media screen {
  .references a {
    white-space: nowrap;
  }
}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin: 0 0 0.25em 0;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/*
  The margin-left: 0 on <dd> removes all distinction
  between levels from nested <dl>s.  Undo that.
*/
dl.olPercent > dd,
dd {
  margin-left: revert;
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
</head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">SD-JWT</td>
<td class="right">October 2022</td>
</tr></thead>
<tfoot><tr>
<td class="left">Fett &amp; Yasuda</td>
<td class="center">Expires 9 April 2023</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Web Authorization Protocol</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-ietf-oauth-selective-disclosure-jwt-00</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2022-10-06" class="published">6 October 2022</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2023-04-09">9 April 2023</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">D. Fett</div>
<div class="org">yes.com</div>
</div>
<div class="author">
      <div class="author-name">K. Yasuda</div>
<div class="org">Microsoft</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Selective Disclosure for JWTs (SD-JWT)</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document specifies conventions for creating JSON Web Token (JWT)
documents that support selective disclosure of JWT claim values.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 9 April 2023.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2022 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a><a href="#section-toc.1-1.1.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1"><a href="#section-1.1" class="xref">1.1</a>.  <a href="#name-conventions-and-terminology" class="xref">Conventions and Terminology</a><a href="#section-toc.1-1.1.2.1.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="xref">2</a>.  <a href="#name-terms-and-definitions" class="xref">Terms and Definitions</a><a href="#section-toc.1-1.2.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-flow-diagram" class="xref">Flow Diagram</a><a href="#section-toc.1-1.3.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-concepts" class="xref">Concepts</a><a href="#section-toc.1-1.4.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="xref">4.1</a>.  <a href="#name-creating-an-sd-jwt" class="xref">Creating an SD-JWT</a><a href="#section-toc.1-1.4.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="xref">4.2</a>.  <a href="#name-creating-an-sd-jwt-release" class="xref">Creating an SD-JWT Release</a><a href="#section-toc.1-1.4.2.2.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="xref">4.3</a>.  <a href="#name-optional-holder-binding" class="xref">Optional Holder Binding</a><a href="#section-toc.1-1.4.2.3.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.4.2.4">
                <p id="section-toc.1-1.4.2.4.1"><a href="#section-4.4" class="xref">4.4</a>.  <a href="#name-optional-claim-name-blindin" class="xref">Optional Claim Name Blinding</a><a href="#section-toc.1-1.4.2.4.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.4.2.5">
                <p id="section-toc.1-1.4.2.5.1"><a href="#section-4.5" class="xref">4.5</a>.  <a href="#name-verifying-an-sd-jwt-release" class="xref">Verifying an SD-JWT Release</a><a href="#section-toc.1-1.4.2.5.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-data-formats" class="xref">Data Formats</a><a href="#section-toc.1-1.5.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="xref">5.1</a>.  <a href="#name-the-challenge-of-canonicali" class="xref">The Challenge of Canonicalization</a><a href="#section-toc.1-1.5.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="xref">5.2</a>.  <a href="#name-format-of-an-sd-jwt" class="xref">Format of an SD-JWT</a><a href="#section-toc.1-1.5.2.2.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.5.2.2.2.1">
                    <p id="section-toc.1-1.5.2.2.2.1.1"><a href="#section-5.2.1" class="xref">5.2.1</a>.  <a href="#name-sd_digests-claim-digests-of" class="xref"><code>sd_digests</code> Claim (Digests of Selectively Disclosable Claims)</a><a href="#section-toc.1-1.5.2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.5.2.2.2.2">
                    <p id="section-toc.1-1.5.2.2.2.2.1"><a href="#section-5.2.2" class="xref">5.2.2</a>.  <a href="#name-hash-function-claim" class="xref">Hash Function Claim</a><a href="#section-toc.1-1.5.2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.5.2.2.2.3">
                    <p id="section-toc.1-1.5.2.2.2.3.1"><a href="#section-5.2.3" class="xref">5.2.3</a>.  <a href="#name-holder-public-key-claim" class="xref">Holder Public Key Claim</a><a href="#section-toc.1-1.5.2.2.2.3.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="xref">5.3</a>.  <a href="#name-example-1-sd-jwt" class="xref">Example 1: SD-JWT</a><a href="#section-toc.1-1.5.2.3.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.5.2.4">
                <p id="section-toc.1-1.5.2.4.1"><a href="#section-5.4" class="xref">5.4</a>.  <a href="#name-format-of-a-sd-jwt-salt-val" class="xref">Format of a SD-JWT Salt/Value Container (SVC)</a><a href="#section-toc.1-1.5.2.4.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.5.2.5">
                <p id="section-toc.1-1.5.2.5.1"><a href="#section-5.5" class="xref">5.5</a>.  <a href="#name-example-svc-for-the-flat-sd" class="xref">Example: SVC for the Flat SD-JWT in Example 1</a><a href="#section-toc.1-1.5.2.5.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.5.2.6">
                <p id="section-toc.1-1.5.2.6.1"><a href="#section-5.6" class="xref">5.6</a>.  <a href="#name-sending-sd-jwt-and-svc-duri" class="xref">Sending SD-JWT and SVC during Issuance</a><a href="#section-toc.1-1.5.2.6.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.5.2.7">
                <p id="section-toc.1-1.5.2.7.1"><a href="#section-5.7" class="xref">5.7</a>.  <a href="#name-format-of-an-sd-jwt-release" class="xref">Format of an SD-JWT Release</a><a href="#section-toc.1-1.5.2.7.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.5.2.8">
                <p id="section-toc.1-1.5.2.8.1"><a href="#section-5.8" class="xref">5.8</a>.  <a href="#name-example-sd-jwt-release-for-" class="xref">Example: SD-JWT Release for Example 1</a><a href="#section-toc.1-1.5.2.8.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.5.2.9">
                <p id="section-toc.1-1.5.2.9.1"><a href="#section-5.9" class="xref">5.9</a>.  <a href="#name-sending-sd-jwt-and-sd-jwt-r" class="xref">Sending SD-JWT and SD-JWT-R during Presentation</a><a href="#section-toc.1-1.5.2.9.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-verification-and-processing" class="xref">Verification and Processing</a><a href="#section-toc.1-1.6.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="xref">6.1</a>.  <a href="#name-verification-by-the-holder-" class="xref">Verification by the Holder when Receiving SD-JWT and SVC</a><a href="#section-toc.1-1.6.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="xref">6.2</a>.  <a href="#name-verification-by-the-verifie" class="xref">Verification by the Verifier when Receiving SD-JWT and SD-JWT-R</a><a href="#section-toc.1-1.6.2.2.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a href="#section-6.3" class="xref">6.3</a>.  <a href="#name-processing-model" class="xref">Processing Model</a><a href="#section-toc.1-1.6.2.3.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-security-considerations" class="xref">Security Considerations</a><a href="#section-toc.1-1.7.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="xref">7.1</a>.  <a href="#name-mandatory-hash-computation-" class="xref">Mandatory hash computation of the revealed claim values by the Verifier</a><a href="#section-toc.1-1.7.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="xref">7.2</a>.  <a href="#name-mandatory-signing-of-the-sd" class="xref">Mandatory signing of the SD-JWT</a><a href="#section-toc.1-1.7.2.2.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a href="#section-7.3" class="xref">7.3</a>.  <a href="#name-entropy-and-uniqueness-of-t" class="xref">Entropy and Uniqueness of the salt</a><a href="#section-toc.1-1.7.2.3.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.7.2.4">
                <p id="section-toc.1-1.7.2.4.1"><a href="#section-7.4" class="xref">7.4</a>.  <a href="#name-minimum-length-of-the-salt" class="xref">Minimum length of the salt</a><a href="#section-toc.1-1.7.2.4.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.7.2.5">
                <p id="section-toc.1-1.7.2.5.1"><a href="#section-7.5" class="xref">7.5</a>.  <a href="#name-choice-of-a-hash-function" class="xref">Choice of a hash function</a><a href="#section-toc.1-1.7.2.5.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.7.2.6">
                <p id="section-toc.1-1.7.2.6.1"><a href="#section-7.6" class="xref">7.6</a>.  <a href="#name-holder-binding" class="xref">Holder Binding</a><a href="#section-toc.1-1.7.2.6.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.7.2.7">
                <p id="section-toc.1-1.7.2.7.1"><a href="#section-7.7" class="xref">7.7</a>.  <a href="#name-blinding-claim-names" class="xref">Blinding Claim Names</a><a href="#section-toc.1-1.7.2.7.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-privacy-considerations" class="xref">Privacy Considerations</a><a href="#section-toc.1-1.8.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="xref">8.1</a>.  <a href="#name-claim-names" class="xref">Claim Names</a><a href="#section-toc.1-1.8.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="xref">8.2</a>.  <a href="#name-unlinkability" class="xref">Unlinkability</a><a href="#section-toc.1-1.8.2.2.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="xref">9</a>.  <a href="#name-acknowledgements" class="xref">Acknowledgements</a><a href="#section-toc.1-1.9.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="xref">10</a>. <a href="#name-iana-considerations" class="xref">IANA Considerations</a><a href="#section-toc.1-1.10.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="xref">11</a>. <a href="#name-normative-references" class="xref">Normative References</a><a href="#section-toc.1-1.11.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-12" class="xref">12</a>. <a href="#name-informative-references" class="xref">Informative References</a><a href="#section-toc.1-1.12.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#section-appendix.a" class="xref">Appendix A</a>.  <a href="#name-additional-examples" class="xref">Additional Examples</a><a href="#section-toc.1-1.13.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.13.2.1">
                <p id="section-toc.1-1.13.2.1.1"><a href="#section-a.1" class="xref">A.1</a>.  <a href="#name-example-2-structured-sd-jwt" class="xref">Example 2 - Structured SD-JWT</a><a href="#section-toc.1-1.13.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.13.2.2">
                <p id="section-toc.1-1.13.2.2.1"><a href="#section-a.2" class="xref">A.2</a>.  <a href="#name-example-3-complex-structure" class="xref">Example 3 - Complex Structured SD-JWT</a><a href="#section-toc.1-1.13.2.2.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.13.2.3">
                <p id="section-toc.1-1.13.2.3.1"><a href="#section-a.3" class="xref">A.3</a>.  <a href="#name-example-4-w3c-verifiable-cr" class="xref">Example 4 - W3C Verifiable Credentials Data Model</a><a href="#section-toc.1-1.13.2.3.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#section-appendix.b" class="xref">Appendix B</a>.  <a href="#name-blinding-claim-names-2" class="xref">Blinding Claim Names</a><a href="#section-toc.1-1.14.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.14.2.1">
                <p id="section-toc.1-1.14.2.1.1"><a href="#section-b.1" class="xref">B.1</a>.  <a href="#name-example-5-some-blinded-clai" class="xref">Example 5: Some Blinded Claims</a><a href="#section-toc.1-1.14.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.14.2.2">
                <p id="section-toc.1-1.14.2.2.1"><a href="#section-b.2" class="xref">B.2</a>.  <a href="#name-example-6-all-claim-names-b" class="xref">Example 6: All Claim Names Blinded</a><a href="#section-toc.1-1.14.2.2.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a href="#section-appendix.c" class="xref">Appendix C</a>.  <a href="#name-document-history" class="xref">Document History</a><a href="#section-toc.1-1.15.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.16">
            <p id="section-toc.1-1.16.1"><a href="#section-appendix.d" class="xref"></a><a href="#name-authors-addresses" class="xref">Authors' Addresses</a><a href="#section-toc.1-1.16.1" class="pilcrow">¶</a></p>
</li>
</ul>
</nav>
</section>
</div>
<div id="Introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">The JSON-based representation of claims in a signed JSON Web Token (JWT) <span>[<a href="#RFC7519" class="xref">RFC7519</a>]</span> is
secured against modification using JSON Web Signature (JWS) <span>[<a href="#RFC7515" class="xref">RFC7515</a>]</span> digital
signatures. A consumer of a signed JWT that has checked the
signature can safely assume that the contents of the token have not been
modified.  However, anyone receiving an unencrypted JWT can read all of the
claims and likewise, anyone with the decryption key receiving an encrypted JWT
can also read all of the claims.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">This document describes a format for signed JWTs that supports selective
disclosure (SD-JWT), enabling sharing only a subset of the claims included in
the original signed JWT instead of releasing all the claims to every verifier.
During issuance, an SD-JWT is sent from the issuer to the holder alongside an
SD-JWT Salt/Value Container (SVC), a JSON object that contains the mapping
between raw claim values contained in the SD-JWT and the salts for each claim
value.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">This document also defines a format for SD-JWT Releases (SD-JWT-R), which convey
a subset of the claim values of an SD-JWT to the verifier. For presentation, the
holder creates an SD-JWT-R and sends it together with the SD-JWT to the
verifier. To verify claim values received in SD-JWT-R, the verifier uses the
salts values in the SD-JWT-R to compute the hash digests of the claim values and
compare them to the ones in the SD-JWT.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">One of the common use cases of a signed JWT is representing a user's identity
created by an issuer. As long as the signed JWT is one-time use, it typically
only contains those claims the user has consented to release to a specific
verifier. However, when a signed JWT is intended to be multi-use, it needs to
contain the superset of all claims the user might want to release to verifiers
at some point. The ability to selectively disclose a subset of these claims
depending on the verifier becomes crucial to ensure minimum disclosure and
prevent verifiers from obtaining claims irrelevant for the transaction at hand.<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5">One example of such a multi-use JWT is a verifiable credential, a
tamper-evident credential with a cryptographically verifiable authorship that
contains claims about a subject. SD-JWTs defined in this document enable such
selective disclosure of claims.<a href="#section-1-5" class="pilcrow">¶</a></p>
<p id="section-1-6">While JWTs for claims describing natural persons are a common use case, the
mechanisms defined in this document can be used for many other use cases as
well.<a href="#section-1-6" class="pilcrow">¶</a></p>
<p id="section-1-7">This document also describes holder binding, or the concept of binding SD-JWT to
key material controlled by the subject of SD-JWT. Holder binding is optional to
implement.<a href="#section-1-7" class="pilcrow">¶</a></p>
<div id="conventions-and-terminology">
<section id="section-1.1">
        <h3 id="name-conventions-and-terminology">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-conventions-and-terminology" class="section-name selfRef">Conventions and Terminology</a>
        </h3>
<p id="section-1.1-1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL
NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED",
"MAY", and "OPTIONAL" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
<p id="section-1.1-2"><strong>base64url</strong> denotes the URL-safe base64 encoding without padding defined in
Section 2 of <span>[<a href="#RFC7515" class="xref">RFC7515</a>]</span>.<a href="#section-1.1-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="terms-and-definitions">
<section id="section-2">
      <h2 id="name-terms-and-definitions">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-terms-and-definitions" class="section-name selfRef">Terms and Definitions</a>
      </h2>
<dl class="dlParallel" id="section-2-1">
        <dt id="section-2-1.1">Selectively Disclosable JWT (SD-JWT)</dt>
<dd id="section-2-1.2">
          <p id="section-2-1.2.1">A JWT <span>[<a href="#RFC7515" class="xref">RFC7515</a>]</span> created by the issuer, which is signed as a JWS <span>[<a href="#RFC7515" class="xref">RFC7515</a>]</span>,
that supports selective disclosure as defined in this document.<a href="#section-2-1.2.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-2-1.3">SD-JWT Salt/Value Container (SVC)</dt>
<dd id="section-2-1.4">
          <p id="section-2-1.4.1">A JSON object created by the issuer that contains mapping between
raw claim values contained in the SD-JWT and the salts for each claim value.<a href="#section-2-1.4.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-2-1.5">SD-JWT Release (SD-JWT-R)</dt>
<dd id="section-2-1.6">
          <p id="section-2-1.6.1">A JWT created by the holder that contains a subset of the claim values of an SD-JWT in a verifiable way.<a href="#section-2-1.6.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-2-1.7">Holder binding</dt>
<dd id="section-2-1.8">
          <p id="section-2-1.8.1">Ability of the holder to prove legitimate possession of SD-JWT by proving
control over the same private key during the issuance and presentation. SD-JWT signed by the issuer contains
a public key or a reference to a public key that matches to the private key controlled by the holder.<a href="#section-2-1.8.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-2-1.9">Claim name blinding</dt>
<dd id="section-2-1.10">
          <p id="section-2-1.10.1">Feature that enables to blind not only claim values, but also claim names of the claims
that are included in SD-JWT but are not disclosed to the verifier in the SD-JWT-Release.<a href="#section-2-1.10.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-2-1.11">Issuer</dt>
<dd id="section-2-1.12">
          <p id="section-2-1.12.1">An entity that creates SD-JWTs (2.1).<a href="#section-2-1.12.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-2-1.13">Holder</dt>
<dd id="section-2-1.14">
          <p id="section-2-1.14.1">An entity that received SD-JWTs (2.1) from the issuer and has control over them.<a href="#section-2-1.14.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-2-1.15">Verifier</dt>
<dd id="section-2-1.16">
          <p id="section-2-1.16.1">An entity that requests, checks and extracts the claims from SD-JWT-R (2.2)<a href="#section-2-1.16.1" class="pilcrow">¶</a></p>
</dd>
</dl>
<p id="section-2-2">Note: discuss if we want to include Client, Authorization Server for the purpose of
ensuring continuity and separating the entity from the actor.<a href="#section-2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="flow-diagram">
<section id="section-3">
      <h2 id="name-flow-diagram">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-flow-diagram" class="section-name selfRef">Flow Diagram</a>
      </h2>
<span id="name-sd-jwt-issuance-and-present"></span><figure id="figure-1">
        <div id="section-3-1.1">
<pre class="sourcecode lang-ascii-art">           +------------+
           |            |
           |   Issuer   |
           |            |
           +------------+
                 |
               Issues
           SD-JWT and SVC
                 |
                 v
           +------------+
           |            |
           |   Holder   |
           |            |
           +------------+
                 |
              Presents
         SD-JWT-R and SD-JWT
                 |
                 v
           +-------------+
           |             |+
           |  Verifiers  ||+
           |             |||
           +-------------+||
            +-------------+|
             +-------------+
</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-sd-jwt-issuance-and-present" class="selfRef">SD-JWT Issuance and Presentation Flow</a>
        </figcaption></figure>
</section>
</div>
<div id="concepts">
<section id="section-4">
      <h2 id="name-concepts">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-concepts" class="section-name selfRef">Concepts</a>
      </h2>
<p id="section-4-1">In the following, the contents of SD-JWTs and SD-JWT Releases are described at a
conceptual level, abstracting from the data formats described afterwards.<a href="#section-4-1" class="pilcrow">¶</a></p>
<div id="creating-an-sd-jwt">
<section id="section-4.1">
        <h3 id="name-creating-an-sd-jwt">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-creating-an-sd-jwt" class="section-name selfRef">Creating an SD-JWT</a>
        </h3>
<p id="section-4.1-1">An SD-JWT, at its core, is a digitally signed document containing hash digests over the claim values with unique random salts and other metadata.
It MUST be digitally signed using the issuer's private key.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-4.1-2">
<pre>SD-JWT-DOC = (METADATA, SD-CLAIMS)
SD-JWT = SD-JWT-DOC | SIG(SD-JWT-DOC, ISSUER-PRIV-KEY)
</pre><a href="#section-4.1-2" class="pilcrow">¶</a>
</div>
<p id="section-4.1-3"><code>SD-CLAIMS</code> can be a simple object with claim names mapped to hash digests over the claim values with unique random salts:<a href="#section-4.1-3" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-4.1-4">
<pre>SD-CLAIMS = (
    CLAIM-NAME: HASH(SALT | CLAIM-VALUE)
)*
</pre><a href="#section-4.1-4" class="pilcrow">¶</a>
</div>
<p id="section-4.1-5">The claim name (<code>CLAIM-NAME</code>) is an optional<a href="#section-4.1-5" class="pilcrow">¶</a></p>
<p id="section-4.1-6"><code>SD-CLAIMS</code> can also be nested deeper to capture more complex objects, as will be shown later.<a href="#section-4.1-6" class="pilcrow">¶</a></p>
<p id="section-4.1-7"><code>SD-JWT</code> is sent from the issuer to the holder, together with the mapping of the plain-text claim values, the salt values, and potentially some other information.<a href="#section-4.1-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="creating-an-sd-jwt-release">
<section id="section-4.2">
        <h3 id="name-creating-an-sd-jwt-release">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-creating-an-sd-jwt-release" class="section-name selfRef">Creating an SD-JWT Release</a>
        </h3>
<p id="section-4.2-1">To disclose to a verifier a subset of the SD-JWT claim values, a holder creates a JWT such as the
following:<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-4.2-2">
<pre>SD-JWT-RELEASE-DOC = (METADATA, SD-RELEASES)
SD-JWT-RELEASE = SD-JWT-RELEASE-DOC
</pre><a href="#section-4.2-2" class="pilcrow">¶</a>
</div>
<p id="section-4.2-3"><code>SD-RELEASES</code> follows the structure of <code>SD-CLAIMS</code> and can be a simple object with claim names mapped to values and salts:<a href="#section-4.2-3" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-4.2-4">
<pre>SD-RELEASES = (
    CLAIM-NAME: (DISCLOSED-SALT, DISCLOSED-VALUE)
)
</pre><a href="#section-4.2-4" class="pilcrow">¶</a>
</div>
<p id="section-4.2-5">Just as <code>SD-CLAIMS</code>, <code>SD-RELEASES</code> can be more complex as well.<a href="#section-4.2-5" class="pilcrow">¶</a></p>
<p id="section-4.2-6"><code>SD-JWT-RELEASE</code> is sent together with <code>SD-JWT</code> from the holder to the
verifier.<a href="#section-4.2-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="optional-holder-binding">
<section id="section-4.3">
        <h3 id="name-optional-holder-binding">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-optional-holder-binding" class="section-name selfRef">Optional Holder Binding</a>
        </h3>
<p id="section-4.3-1">Some use-cases may require holder binding.<a href="#section-4.3-1" class="pilcrow">¶</a></p>
<p id="section-4.3-2">If holder binding is desired, <code>SD-JWT</code> must contain information about key material controlled by the holder:<a href="#section-4.3-2" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-4.3-3">
<pre>SD-JWT-DOC = (METADATA, HOLDER-PUBLIC-KEY, SD-CLAIMS)
</pre><a href="#section-4.3-3" class="pilcrow">¶</a>
</div>
<p id="section-4.3-4">Note: How the public key is included in SD-JWT is out of scope of this document. It can be passed by value or by reference.<a href="#section-4.3-4" class="pilcrow">¶</a></p>
<p id="section-4.3-5">With holder binding, the <code>SD-JWT-RELEASE</code> is signed by the holder using its private key. It therefore looks as follows:<a href="#section-4.3-5" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-4.3-6">
<pre>SD-JWT-RELEASE = SD-JWT-RELEASE-DOC | SIG(SD-JWT-RELEASE-DOC, HOLDER-PRIV-KEY)
</pre><a href="#section-4.3-6" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="optional-claim-name-blinding">
<section id="section-4.4">
        <h3 id="name-optional-claim-name-blindin">
<a href="#section-4.4" class="section-number selfRef">4.4. </a><a href="#name-optional-claim-name-blindin" class="section-name selfRef">Optional Claim Name Blinding</a>
        </h3>
<p id="section-4.4-1">If claim name blinding is used, <code>SD-CLAIMS</code> is created as follows:<a href="#section-4.4-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-4.4-2">
<pre>SD-CLAIMS = (
    CLAIM-NAME-PLACEHOLDER: HASH(SALT | CLAIM-VALUE | CLAIM-NAME)
)*
</pre><a href="#section-4.4-2" class="pilcrow">¶</a>
</div>
<p id="section-4.4-3"><code>CLAIM-NAME-PLACEHOLDER</code> is a placeholder used instead of the original claim
name, chosen such that it does not leak information about the claim name (e.g.,
randomly).<a href="#section-4.4-3" class="pilcrow">¶</a></p>
<p id="section-4.4-4">The contents of <code>SD-RELEASES</code> are modified as follows:<a href="#section-4.4-4" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-4.4-5">
<pre>SD-RELEASES = (
    CLAIM-NAME-PLACEHOLDER: (DISCLOSED-SALT, DISCLOSED-VALUE, DISCLOSED-CLAIM-NAME)
)
</pre><a href="#section-4.4-5" class="pilcrow">¶</a>
</div>
<p id="section-4.4-6">Note that blinded and unblinded claim names can be mixed in <code>SD-CLAIMS</code> and accordingly in <code>SD-RELEASES</code>.<a href="#section-4.4-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="verifying-an-sd-jwt-release">
<section id="section-4.5">
        <h3 id="name-verifying-an-sd-jwt-release">
<a href="#section-4.5" class="section-number selfRef">4.5. </a><a href="#name-verifying-an-sd-jwt-release" class="section-name selfRef">Verifying an SD-JWT Release</a>
        </h3>
<p id="section-4.5-1">A verifier checks that<a href="#section-4.5-1" class="pilcrow">¶</a></p>
<ul>
<li id="section-4.5-2.1">
            <p id="section-4.5-2.1.1">for each claim in <code>SD-JWT-RELEASE</code>, the hash digest over the disclosed values
matches the hash digest under the given claim name in <code>SD-JWT</code>,<a href="#section-4.5-2.1.1" class="pilcrow">¶</a></p>
</li>
<li id="section-4.5-2.2">
            <p id="section-4.5-2.2.1">if holder binding is used, the <code>SD-JWT-RELEASE</code> was signed by the private key
belonging to <code>HOLDER-PUBLIC-KEY</code>.<a href="#section-4.5-2.2.1" class="pilcrow">¶</a></p>
</li>
</ul>
<p id="section-4.5-3">The detailed algorithm is described below.<a href="#section-4.5-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="data-formats">
<section id="section-5">
      <h2 id="name-data-formats">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-data-formats" class="section-name selfRef">Data Formats</a>
      </h2>
<p id="section-5-1">This section defines data formats for SD-JWTs (containing hash digests of the salted
claim values), SD-JWT Salt/Value Containers (containing the mapping of the
plain-text claim values and the salt values), and SD-JWT Releases (containing a
subset of the same mapping).<a href="#section-5-1" class="pilcrow">¶</a></p>
<div id="the-challenge-of-canonicalization">
<section id="section-5.1">
        <h3 id="name-the-challenge-of-canonicali">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-the-challenge-of-canonicali" class="section-name selfRef">The Challenge of Canonicalization</a>
        </h3>
<p id="section-5.1-1">When receiving an SD-JWT with an associated Release, a verifier must be able to
re-compute digests of the disclosed claim value and, given the same input values,
obtain the same digest values as signed by the issuer.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1-2">Usually, JSON-based formats transport claim values as simple properties of a JSON object such as this:<a href="#section-5.1-2" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-5.1-3">
<pre>...
  "family_name": "Möbius",
  "address": {
    "street_address": "Schulstr. 12",
    "locality": "Schulpforta"
  }
...
</pre><a href="#section-5.1-3" class="pilcrow">¶</a>
</div>
<p id="section-5.1-4">However, a problem arises when signatures over the data need to be computed and
verified. Common signature schemes require the same byte string as input to the
signature verification as was used for creating the signature. In the salted
hash approach outlined above, the same problem exists: For the issuer and the
verifier to arrive at the same hash digest, the same byte string must be hashed.<a href="#section-5.1-4" class="pilcrow">¶</a></p>
<p id="section-5.1-5">JSON, however, does not prescribe a unique encoding for data, but allows for variations in the encoded string. The data above, for example, can be encoded as<a href="#section-5.1-5" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-5.1-6">
<pre>...
"family_name": "M\u00f6bius",
"address": {"street_address": "Schulstr. 12", "locality": "Schulpforta"}
...
</pre><a href="#section-5.1-6" class="pilcrow">¶</a>
</div>
<p id="section-5.1-7">or as<a href="#section-5.1-7" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-5.1-8">
<pre>...
"family_name": "Möbius",
"address": {"locality":"Schulpforta", "street_address":"Schulstr. 12"}
...
</pre><a href="#section-5.1-8" class="pilcrow">¶</a>
</div>
<p id="section-5.1-9">The two representations <code>"M\u00f6bius"</code> and <code>"M&amp;#246;bius"</code> are very different on the byte-level, but yield
equivalent objects. Same for the representations <code>{"street_address": "Schulstr. 12", "locality": "Schulpforta"}</code> and <code>{"locality":"Schulpforta", "street_address":"Schulstr. 12"}</code>.<a href="#section-5.1-9" class="pilcrow">¶</a></p>
<p id="section-5.1-10">The variations in white space, ordering of object properties, and encoding of
Unicode characters are all allowed by the JSON specification. Other variations,
e.g., concerning floating-point numbers, are described in <span>[<a href="#RFC8785" class="xref">RFC8785</a>]</span>. Variations
can be introduced whenever JSON data is serialized or deserialized and unless
dealt with, will lead to different hashes and the inability to verify
signatures.<a href="#section-5.1-10" class="pilcrow">¶</a></p>
<p id="section-5.1-11">There are generally two approaches to deal with this problem:<a href="#section-5.1-11" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.1-12">
          <li id="section-5.1-12.1">
            <p id="section-5.1-12.1.1">Canonicalization: The data is transferred in JSON format, potentially
introducing variations in its representation, but is transformed into a
canonical form before hashing. Both the issuer and the verifier
must use the same canonicalization algorithm to arrive at the same byte
string for hashing.<a href="#section-5.1-12.1.1" class="pilcrow">¶</a></p>
</li>
<li id="section-5.1-12.2">
            <p id="section-5.1-12.2.1">Source-string encoding: Instead of transferring data in JSON format that may
introduce variations, the serialized data that is used as the hash input is
transferred from the issuer to the verifier. This means that the verifier can
easily check the hash over the byte string before deserializing the data.<a href="#section-5.1-12.2.1" class="pilcrow">¶</a></p>
</li>
</ol>
<p id="section-5.1-13">Mixed approaches are conceivable, i.e., transferring both the original JSON data
plus a string suitable for hashing, but such approaches can easily lead to
undetected inconsistencies resulting in time-of-check-time-of-use type security
vulnerabilities.<a href="#section-5.1-13" class="pilcrow">¶</a></p>
<p id="section-5.1-14">In this specification, the source-string encoding approach is used, as it allows
for simple and reliable interoperability without the requirement for a
canonicalization library. To encode the source string, JSON itself is used. To
produce a source-string for hashing, the data is put into a JSON object together
with the salt value, like so (non-normative example, see <a href="#sd_digests_claim" class="xref">Section 5.2.1</a> for
details):<a href="#section-5.1-14" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-5.1-15">
<pre>{"s": "6qMQvRL5haj", "v": "Möbius"}
</pre><a href="#section-5.1-15" class="pilcrow">¶</a>
</div>
<p id="section-5.1-16">Or, for the address example above:<a href="#section-5.1-16" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-5.1-17">
<pre>{"s": "al1N3Zom221", "v": {"locality":"Schulpforta", "street_address":"Schulstr. 12"}}
</pre><a href="#section-5.1-17" class="pilcrow">¶</a>
</div>
<p id="section-5.1-18">This object is then JSON-encoded and used as the source string. The JSON-encoded value is transferred in the SD-JWT-Release instead of the original JSON data:<a href="#section-5.1-18" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-5.1-19">
<pre>"family_name": "{\"s\": \"6qMQvRL5haj\", \"v\": \"M\\u00f6bius\"}"
</pre><a href="#section-5.1-19" class="pilcrow">¶</a>
</div>
<p id="section-5.1-20">Or, for the address example:<a href="#section-5.1-20" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-5.1-21">
<pre>"address": "{\"s\": \"al1N3Zom221\", \"v\": {\"locality\": \"Schulpforta\", \"street_address\": \"Schulstr. 12\"}}"
</pre><a href="#section-5.1-21" class="pilcrow">¶</a>
</div>
<p id="section-5.1-22">A verifier can then easily check the hash over the source string before
extracting the original JSON data. Variations in the encoding of the source
string are implicitly tolerated by the verifier, as the hash is computed over a
predefined byte string and not over a JSON object.<a href="#section-5.1-22" class="pilcrow">¶</a></p>
<p id="section-5.1-23">Since the encoding is based on JSON, all value types that are allowed in JSON
are also allowed in the <code>v</code> property in the source string. This includes
numbers, strings, booleans, arrays, and objects.<a href="#section-5.1-23" class="pilcrow">¶</a></p>
<p id="section-5.1-24">It is important to note that the SD-JWT-Release containing the source string is
neither intended nor suitable for direct consumption by an application that
needs to access the disclosed claim values. The SD-JWT-Release is only intended
to be used by a verifier to check the hash over the source string and to extract
the original JSON data. The original JSON data is then used by the application.
See <a href="#processing_model" class="xref">Section 6.3</a> for details.<a href="#section-5.1-24" class="pilcrow">¶</a></p>
<p id="section-5.1-25">Using this approach, SD-JWTs can be implemented purely based on widely available
JSON encoding and decoding libraries.<a href="#section-5.1-25" class="pilcrow">¶</a></p>
</section>
</div>
<div id="format-of-an-sd-jwt">
<section id="section-5.2">
        <h3 id="name-format-of-an-sd-jwt">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-format-of-an-sd-jwt" class="section-name selfRef">Format of an SD-JWT</a>
        </h3>
<p id="section-5.2-1">An SD-JWT is a JWT that MUST be signed using the issuer's private key. The
payload of an SD-JWT MUST contain the <code>sd_digests</code> and <code>sd_hash_alg</code> claims
described in the following, and MAY contain a holder's public key or a reference
thereto, as well as further claims such as <code>iss</code>, <code>iat</code>, etc. as defined or
required by the application using SD-JWTs.<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<div id="sd_digests_claim">
<section id="section-5.2.1">
          <h4 id="name-sd_digests-claim-digests-of">
<a href="#section-5.2.1" class="section-number selfRef">5.2.1. </a><a href="#name-sd_digests-claim-digests-of" class="section-name selfRef"><code>sd_digests</code> Claim (Digests of Selectively Disclosable Claims)</a>
          </h4>
<p id="section-5.2.1-1">An SD-JWT MUST include hash digests of the salted claim values that are included by the issuer
under the property <code>sd_digests</code>.<a href="#section-5.2.1-1" class="pilcrow">¶</a></p>
<p id="section-5.2.1-2">The issuer MUST choose a unique and cryptographically random salt value
for each claim value. Each salt value
SHOULD contain at least 128 bits of pseudorandom data, making it hard for an
attacker to guess. The salt value MUST then be encoded as a string. It is
RECOMMENDED to base64url-encode the salt value.<a href="#section-5.2.1-2" class="pilcrow">¶</a></p>
<p id="section-5.2.1-3">The issuer MUST build the digests by hashing over a JSON literal according to
<span>[<a href="#RFC8259" class="xref">RFC8259</a>]</span> that is formed by
JSON-encoding an object with the following contents:<a href="#section-5.2.1-3" class="pilcrow">¶</a></p>
<ul>
<li id="section-5.2.1-4.1">
              <p id="section-5.2.1-4.1.1">REQUIRED with the key <code>s</code>: the salt value,<a href="#section-5.2.1-4.1.1" class="pilcrow">¶</a></p>
</li>
<li id="section-5.2.1-4.2">
              <p id="section-5.2.1-4.2.1">REQUIRED with the key <code>v</code>: the claim value (either a string or a more complex object, e.g., for the x@OIDCx <code>address</code> claim),<a href="#section-5.2.1-4.2.1" class="pilcrow">¶</a></p>
</li>
<li id="section-5.2.1-4.3">
              <p id="section-5.2.1-4.3.1">OPTIONAL, with the key <code>n</code>: the claim name (if claim name blinding is to be used for this claim).<a href="#section-5.2.1-4.3.1" class="pilcrow">¶</a></p>
</li>
</ul>
<p id="section-5.2.1-5">The following is an example for a JSON literal without claim name blinding:<a href="#section-5.2.1-5" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-5.2.1-6">
<pre>{"s": "6qMQvRL5haj", "v": "Peter"}
</pre><a href="#section-5.2.1-6" class="pilcrow">¶</a>
</div>
<p id="section-5.2.1-7">The following is an example for a JSON literal with claim name blinding:<a href="#section-5.2.1-7" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-5.2.1-8">
<pre>{"s": "6qMQvRL5haj", "v": "Peter", "n": "given_name"}
</pre><a href="#section-5.2.1-8" class="pilcrow">¶</a>
</div>
<p id="section-5.2.1-9">The <code>sd_digests</code> claim contains an object where claim names are mapped to the
respective digests. If a claim name is to be blinded, the digests MUST contain
the <code>n</code> key as described above and the claim name in <code>sd_digests</code> MUST be
replaced by a placeholder value that does not leak information about the claim's original name. The same placeholder value is to be used in the SVC and SD-JWT-R described below.<a href="#section-5.2.1-9" class="pilcrow">¶</a></p>
<div id="flat-and-structured-sd-digests-objects">
<section id="section-5.2.1.1">
            <h5 id="name-flat-and-structured-sd_dige">
<a href="#section-5.2.1.1" class="section-number selfRef">5.2.1.1. </a><a href="#name-flat-and-structured-sd_dige" class="section-name selfRef">Flat and Structured <code>sd_digests</code> objects</a>
            </h5>
<p id="section-5.2.1.1-1">The <code>sd_digests</code> object can be a 'flat' object, directly containing all claim
names and hashed claim values without any deeper structure. The <code>sd_digests</code>
object can also be a 'structured' object, where some claims and their respective
hash digests are contained in places deeper in the structure. It is at the issuer's
discretion whether to use a 'flat' or 'structured' <code>sd_digests</code> SD-JWT object,
and how to structure it such that it is suitable for the use case.<a href="#section-5.2.1.1-1" class="pilcrow">¶</a></p>
<p id="section-5.2.1.1-2">Example 1 below is a non-normative example of an SD-JWT using a 'flat'
<code>sd_digests</code> object and Example 2 in the appendix shows a non-normative example
of an SD-JWT using a 'structured' <code>sd_digests</code> object. The difference between
the examples is how the <code>address</code> claim is disclosed.<a href="#section-5.2.1.1-2" class="pilcrow">¶</a></p>
<p id="section-5.2.1.1-3">Appendix 2 shows a more complex example using claims from eKYC (todo:
reference).<a href="#section-5.2.1.1-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="hash-function-claim">
<section id="section-5.2.2">
          <h4 id="name-hash-function-claim">
<a href="#section-5.2.2" class="section-number selfRef">5.2.2. </a><a href="#name-hash-function-claim" class="section-name selfRef">Hash Function Claim</a>
          </h4>
<p id="section-5.2.2-1">The claim <code>sd_hash_alg</code> indicates the hash algorithm used by the Issuer to generate
the hashes of the salted claim values. The hash algorithm identifier MUST be a
value from the "Hash Name String" column in the IANA "Named Information Hash
Algorithm" registry [IANA.Hash.Algorithms]. SD-JWTs with hash algorithm
identifiers not found in this registry are not considered valid and MUST NOT be
accepted by verifiers.<a href="#section-5.2.2-1" class="pilcrow">¶</a></p>
<p id="section-5.2.2-2">To promote interoperability, implementations MUST support the SHA-256 hash algorithm.<a href="#section-5.2.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="holder-public-key-claim">
<section id="section-5.2.3">
          <h4 id="name-holder-public-key-claim">
<a href="#section-5.2.3" class="section-number selfRef">5.2.3. </a><a href="#name-holder-public-key-claim" class="section-name selfRef">Holder Public Key Claim</a>
          </h4>
<p id="section-5.2.3-1">If the issuer wants to enable holder binding, it MAY include a public key
associated with the holder, or a reference thereto.<a href="#section-5.2.3-1" class="pilcrow">¶</a></p>
<p id="section-5.2.3-2">It is out of the scope of this document to describe how the holder key pair is
established. For example, the holder MAY provide a key pair to the issuer,
the issuer MAY create the key pair for the holder, or
holder and issuer MAY use pre-established key material.<a href="#section-5.2.3-2" class="pilcrow">¶</a></p>
<p id="section-5.2.3-3">Note: Examples in this document use <code>cnf</code> Claim defined in <span>[<a href="#RFC7800" class="xref">RFC7800</a>]</span> to include raw public key by value in SD-JWT.<a href="#section-5.2.3-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="example-1-sd-jwt">
<section id="section-5.3">
        <h3 id="name-example-1-sd-jwt">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-example-1-sd-jwt" class="section-name selfRef">Example 1: SD-JWT</a>
        </h3>
<p id="section-5.3-1">This example and Example 2 in the appendix use the following object as the set
of claims that the Issuer is issuing:<a href="#section-5.3-1" class="pilcrow">¶</a></p>
<div id="example-simple-user_claims">
<div id="section-5.3-2">
<pre class="sourcecode lang-json">{
  "sub": "6c5c0a49-b589-431d-bae7-219122a9ec2c",
  "given_name": "John",
  "family_name": "Doe",
  "email": "johndoe@example.com",
  "phone_number": "+1-202-555-0101",
  "address": {
    "street_address": "123 Main St",
    "locality": "Anytown",
    "region": "Anystate",
    "country": "US"
  },
  "birthdate": "1940-01-01"
}
</pre><a href="#section-5.3-2" class="pilcrow">¶</a>
</div>
</div>
<p id="section-5.3-3">The following non-normative example shows the payload of an SD-JWT. The issuer
is using a flat structure, i.e., all of the claims the <code>address</code> claim can only
be disclosed in full.<a href="#section-5.3-3" class="pilcrow">¶</a></p>
<div id="example-simple-sd_jwt_payload">
<div id="section-5.3-4">
<pre class="sourcecode lang-json">{
  "iss": "https://example.com/issuer",
  "cnf": {
    "jwk": {
      "kty": "RSA",
      "n": "pm4bOHBg-oYhAyPWzR56AWX3rUIXp11_ICDkGgS6W3ZWLts-hzwI3x65659kg4hVo9dbGoCJE3ZGF_eaetE30UhBUEgpGwrDrQiJ9zqprmcFfr3qvvkGjtth8Zgl1eM2bJcOwE7PCBHWTKWYs152R7g6Jg2OVph-a8rq-q79MhKG5QoW_mTz10QT_6H4c7PjWG1fjh8hpWNnbP_pv6d1zSwZfc5fl6yVRL0DV0V3lGHKe2Wqf_eNGjBrBLVklDTk8-stX_MWLcR-EGmXAOv0UBWitS_dXJKJu-vXJyw14nHSGuxTIK2hx1pttMft9CsvqimXKeDTU14qQL1eE7ihcw",
      "e": "AQAB"
    }
  },
  "iat": 1516239022,
  "exp": 1516247022,
  "sd_hash_alg": "sha-256",
  "sd_digests": {
    "sub": "OMdwkk2HPuiInPypWUWMxot1Y2tStGsLuIcDMjKdXMU",
    "given_name": "AfKKH4a0IZki8MFDythFaFS_Xqzn-wRvAMfiy_VjYpE",
    "family_name": "eUmXmry32JiK_76xMasagkAQQsmSVdW57Ajk18riSF0",
    "email": "-Rcr4fDyjwlM_itcMxoQZCE1QAEwyLJcibEpH114KiE",
    "phone_number": "Jv2nw0C1wP5ASutYNAxrWEnaDRIpiF0eTUAkUOp8F6Y",
    "address": "ZrjKs-RmEAVeAYSzSw6GPFrMpcgctCfaJ6t9qQhbfJ4",
    "birthdate": "qXPRRPdpNaebP8jtbEpO-skF4n7v7ASTh8oLg0mkAdQ"
  }
}
</pre><a href="#section-5.3-4" class="pilcrow">¶</a>
</div>
</div>
<p id="section-5.3-5">The SD-JWT is then signed by the issuer to create a document like the following:<a href="#section-5.3-5" class="pilcrow">¶</a></p>
<div id="example-simple-serialized_sd_jwt">
<div class="artwork art-text alignLeft" id="section-5.3-6">
<pre>eyJhbGciOiAiUlMyNTYiLCAia2lkIjogImNBRUlVcUowY21MekQxa3pHemhlaUJhZzBZUk
F6VmRsZnhOMjgwTmdIYUEifQ.eyJpc3MiOiAiaHR0cHM6Ly9leGFtcGxlLmNvbS9pc3N1Z
XIiLCAiY25mIjogeyJqd2siOiB7Imt0eSI6ICJSU0EiLCAibiI6ICJwbTRiT0hCZy1vWWh
BeVBXelI1NkFXWDNyVUlYcDExX0lDRGtHZ1M2VzNaV0x0cy1oendJM3g2NTY1OWtnNGhWb
zlkYkdvQ0pFM1pHRl9lYWV0RTMwVWhCVUVncEd3ckRyUWlKOXpxcHJtY0ZmcjNxdnZrR2p
0dGg4WmdsMWVNMmJKY093RTdQQ0JIV1RLV1lzMTUyUjdnNkpnMk9WcGgtYThycS1xNzlNa
EtHNVFvV19tVHoxMFFUXzZINGM3UGpXRzFmamg4aHBXTm5iUF9wdjZkMXpTd1pmYzVmbDZ
5VlJMMERWMFYzbEdIS2UyV3FmX2VOR2pCckJMVmtsRFRrOC1zdFhfTVdMY1ItRUdtWEFPd
jBVQldpdFNfZFhKS0p1LXZYSnl3MTRuSFNHdXhUSUsyaHgxcHR0TWZ0OUNzdnFpbVhLZUR
UVTE0cVFMMWVFN2loY3ciLCAiZSI6ICJBUUFCIn19LCAiaWF0IjogMTUxNjIzOTAyMiwgI
mV4cCI6IDE1MTYyNDcwMjIsICJzZF9oYXNoX2FsZyI6ICJzaGEtMjU2IiwgInNkX2RpZ2V
zdHMiOiB7InN1YiI6ICJPTWR3a2sySFB1aUluUHlwV1VXTXhvdDFZMnRTdEdzTHVJY0RNa
ktkWE1VIiwgImdpdmVuX25hbWUiOiAiQWZLS0g0YTBJWmtpOE1GRHl0aEZhRlNfWHF6bi1
3UnZBTWZpeV9WallwRSIsICJmYW1pbHlfbmFtZSI6ICJlVW1YbXJ5MzJKaUtfNzZ4TWFzY
WdrQVFRc21TVmRXNTdBamsxOHJpU0YwIiwgImVtYWlsIjogIi1SY3I0ZkR5andsTV9pdGN
NeG9RWkNFMVFBRXd5TEpjaWJFcEgxMTRLaUUiLCAicGhvbmVfbnVtYmVyIjogIkp2Mm53M
EMxd1A1QVN1dFlOQXhyV0VuYURSSXBpRjBlVFVBa1VPcDhGNlkiLCAiYWRkcmVzcyI6ICJ
acmpLcy1SbUVBVmVBWVN6U3c2R1BGck1wY2djdENmYUo2dDlxUWhiZko0IiwgImJpcnRoZ
GF0ZSI6ICJxWFBSUlBkcE5hZWJQOGp0YkVwTy1za0Y0bjd2N0FTVGg4b0xnMG1rQWRRIn1
9.QgoJn9wkjFvM9bAr0hTDHLspuqdA21WzfBRVHkASa2ck4PFD3TC9MiZSi3AiRytRbYT4
ZzvkH3BSbm6vy68y62gj0A6OYvZ1Z60Wxho14bxZQveJZgw3u_lMvYj6GKiUtskypFEHU-
Kd-LoDVqEpf6lPQHdpsac__yQ_JL24oCEBlVQRXB-T-6ZNZfID6JafSkNNCYQbI8nXbzIE
p1LBFm0fE8eUd4G4yPYOj1SeuR6Gy92T0vAoL5QtpIAHo49oAmiSIj6DQNl2cNYs74jhrB
IcNZyt4l8H1lV20wS5OS3T0vXaYD13fgm0p4iWD9cVg3HKShUVulEyrSbq94jIKg
</pre><a href="#section-5.3-6" class="pilcrow">¶</a>
</div>
</div>
<p id="section-5.3-7">(Line breaks for presentation only.)<a href="#section-5.3-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="format-of-a-sd-jwt-salt-value-container-svc">
<section id="section-5.4">
        <h3 id="name-format-of-a-sd-jwt-salt-val">
<a href="#section-5.4" class="section-number selfRef">5.4. </a><a href="#name-format-of-a-sd-jwt-salt-val" class="section-name selfRef">Format of a SD-JWT Salt/Value Container (SVC)</a>
        </h3>
<p id="section-5.4-1">Besides the SD-JWT itself, the holder needs to learn the raw claim values that
are contained in the SD-JWT, along with the precise input to the hash
calculation, and the salts. There MAY be other information the issuer needs to
communicate to the holder, such as a private key if the issuer selected the
holder key pair.<a href="#section-5.4-1" class="pilcrow">¶</a></p>
<p id="section-5.4-2">A SD-JWT Salt/Value Container (SVC) is a JSON object containing at least the
top-level property <code>sd_release</code>. Its structure mirrors the one of <code>sd_digests</code> in
the SD-JWT, but the values are the inputs to the hash calculations the issuer
used, as strings.<a href="#section-5.4-2" class="pilcrow">¶</a></p>
<p id="section-5.4-3">The SVC MAY contain further properties, for example, to transport the holder
private key.<a href="#section-5.4-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="example-svc-for-the-flat-sd-jwt-in-example-1">
<section id="section-5.5">
        <h3 id="name-example-svc-for-the-flat-sd">
<a href="#section-5.5" class="section-number selfRef">5.5. </a><a href="#name-example-svc-for-the-flat-sd" class="section-name selfRef">Example: SVC for the Flat SD-JWT in Example 1</a>
        </h3>
<p id="section-5.5-1">The SVC for Example 1 is as follows:<a href="#section-5.5-1" class="pilcrow">¶</a></p>
<div id="example-simple-svc_payload">
<div id="section-5.5-2">
<pre class="sourcecode lang-json">{
  "sd_release": {
    "sub": "{\"s\": \"2GLC42sKQveCfGfryNRN9w\", \"v\": \"6c5c0a49-b589-431d-bae7-219122a9ec2c\"}",
    "given_name": "{\"s\": \"6Ij7tM-a5iVPGboS5tmvVA\", \"v\": \"John\"}",
    "family_name": "{\"s\": \"Qg_O64zqAxe412a108iroA\", \"v\": \"Doe\"}",
    "email": "{\"s\": \"Pc33JM2LchcU_lHggv_ufQ\", \"v\": \"johndoe@example.com\"}",
    "phone_number": "{\"s\": \"lklxF5jMYlGTPUovMNIvCA\", \"v\": \"+1-202-555-0101\"}",
    "address": "{\"s\": \"5bPs1IquZNa0hkaFzzzZNw\", \"v\": {\"street_address\": \"123 Main St\", \"locality\": \"Anytown\", \"region\": \"Anystate\", \"country\": \"US\"}}",
    "birthdate": "{\"s\": \"y1sVU5wdfJahVdgwPgS7RQ\", \"v\": \"1940-01-01\"}"
  }
}
</pre><a href="#section-5.5-2" class="pilcrow">¶</a>
</div>
</div>
<p id="section-5.5-3">Important: As described above, hash digests are calculated over the JSON literal
formed by serializing an object containing the salt, the claim value, and
optionally the claim name. This ensures that issuer and verifier use the same
input to their hash functions and avoids issues with canonicalization of JSON
values that would lead to different hash digests. The SVC therefore maps claim
names to JSON-encoded arrays.<a href="#section-5.5-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sending-sd-jwt-and-svc-during-issuance">
<section id="section-5.6">
        <h3 id="name-sending-sd-jwt-and-svc-duri">
<a href="#section-5.6" class="section-number selfRef">5.6. </a><a href="#name-sending-sd-jwt-and-svc-duri" class="section-name selfRef">Sending SD-JWT and SVC during Issuance</a>
        </h3>
<p id="section-5.6-1">For transporting the SVC together with the SD-JWT from the issuer to the holder,
the SVC is base64url-encoded and appended to the SD-JWT using a period character <code>.</code> as the
separator.<a href="#section-5.6-1" class="pilcrow">¶</a></p>
<p id="section-5.6-2">The SVC and SD-JWT are implicitly linked through the hash values of the claims
in the SVC that is included in the SD-JWT. To ensure that the correct SVC and
SD-JWT pairings are being used, the holder SHOULD verify the binding between
SVC and SD-JWT as defined in the Verification Section of this document.<a href="#section-5.6-2" class="pilcrow">¶</a></p>
<p id="section-5.6-3">For Example 1, the combined format looks as follows:<a href="#section-5.6-3" class="pilcrow">¶</a></p>
<div id="example-simple-combined_sd_jwt_svc">
<div class="artwork art-text alignLeft" id="section-5.6-4">
<pre>eyJhbGciOiAiUlMyNTYiLCAia2lkIjogImNBRUlVcUowY21MekQxa3pHemhlaUJhZzBZUk
F6VmRsZnhOMjgwTmdIYUEifQ.eyJpc3MiOiAiaHR0cHM6Ly9leGFtcGxlLmNvbS9pc3N1Z
XIiLCAiY25mIjogeyJqd2siOiB7Imt0eSI6ICJSU0EiLCAibiI6ICJwbTRiT0hCZy1vWWh
BeVBXelI1NkFXWDNyVUlYcDExX0lDRGtHZ1M2VzNaV0x0cy1oendJM3g2NTY1OWtnNGhWb
zlkYkdvQ0pFM1pHRl9lYWV0RTMwVWhCVUVncEd3ckRyUWlKOXpxcHJtY0ZmcjNxdnZrR2p
0dGg4WmdsMWVNMmJKY093RTdQQ0JIV1RLV1lzMTUyUjdnNkpnMk9WcGgtYThycS1xNzlNa
EtHNVFvV19tVHoxMFFUXzZINGM3UGpXRzFmamg4aHBXTm5iUF9wdjZkMXpTd1pmYzVmbDZ
5VlJMMERWMFYzbEdIS2UyV3FmX2VOR2pCckJMVmtsRFRrOC1zdFhfTVdMY1ItRUdtWEFPd
jBVQldpdFNfZFhKS0p1LXZYSnl3MTRuSFNHdXhUSUsyaHgxcHR0TWZ0OUNzdnFpbVhLZUR
UVTE0cVFMMWVFN2loY3ciLCAiZSI6ICJBUUFCIn19LCAiaWF0IjogMTUxNjIzOTAyMiwgI
mV4cCI6IDE1MTYyNDcwMjIsICJzZF9oYXNoX2FsZyI6ICJzaGEtMjU2IiwgInNkX2RpZ2V
zdHMiOiB7InN1YiI6ICJPTWR3a2sySFB1aUluUHlwV1VXTXhvdDFZMnRTdEdzTHVJY0RNa
ktkWE1VIiwgImdpdmVuX25hbWUiOiAiQWZLS0g0YTBJWmtpOE1GRHl0aEZhRlNfWHF6bi1
3UnZBTWZpeV9WallwRSIsICJmYW1pbHlfbmFtZSI6ICJlVW1YbXJ5MzJKaUtfNzZ4TWFzY
WdrQVFRc21TVmRXNTdBamsxOHJpU0YwIiwgImVtYWlsIjogIi1SY3I0ZkR5andsTV9pdGN
NeG9RWkNFMVFBRXd5TEpjaWJFcEgxMTRLaUUiLCAicGhvbmVfbnVtYmVyIjogIkp2Mm53M
EMxd1A1QVN1dFlOQXhyV0VuYURSSXBpRjBlVFVBa1VPcDhGNlkiLCAiYWRkcmVzcyI6ICJ
acmpLcy1SbUVBVmVBWVN6U3c2R1BGck1wY2djdENmYUo2dDlxUWhiZko0IiwgImJpcnRoZ
GF0ZSI6ICJxWFBSUlBkcE5hZWJQOGp0YkVwTy1za0Y0bjd2N0FTVGg4b0xnMG1rQWRRIn1
9.QgoJn9wkjFvM9bAr0hTDHLspuqdA21WzfBRVHkASa2ck4PFD3TC9MiZSi3AiRytRbYT4
ZzvkH3BSbm6vy68y62gj0A6OYvZ1Z60Wxho14bxZQveJZgw3u_lMvYj6GKiUtskypFEHU-
Kd-LoDVqEpf6lPQHdpsac__yQ_JL24oCEBlVQRXB-T-6ZNZfID6JafSkNNCYQbI8nXbzIE
p1LBFm0fE8eUd4G4yPYOj1SeuR6Gy92T0vAoL5QtpIAHo49oAmiSIj6DQNl2cNYs74jhrB
IcNZyt4l8H1lV20wS5OS3T0vXaYD13fgm0p4iWD9cVg3HKShUVulEyrSbq94jIKg.eyJzZ
F9yZWxlYXNlIjogeyJzdWIiOiAie1wic1wiOiBcIjJHTEM0MnNLUXZlQ2ZHZnJ5TlJOOXd
cIiwgXCJ2XCI6IFwiNmM1YzBhNDktYjU4OS00MzFkLWJhZTctMjE5MTIyYTllYzJjXCJ9I
iwgImdpdmVuX25hbWUiOiAie1wic1wiOiBcIjZJajd0TS1hNWlWUEdib1M1dG12VkFcIiw
gXCJ2XCI6IFwiSm9oblwifSIsICJmYW1pbHlfbmFtZSI6ICJ7XCJzXCI6IFwiUWdfTzY0e
nFBeGU0MTJhMTA4aXJvQVwiLCBcInZcIjogXCJEb2VcIn0iLCAiZW1haWwiOiAie1wic1w
iOiBcIlBjMzNKTTJMY2hjVV9sSGdndl91ZlFcIiwgXCJ2XCI6IFwiam9obmRvZUBleGFtc
GxlLmNvbVwifSIsICJwaG9uZV9udW1iZXIiOiAie1wic1wiOiBcImxrbHhGNWpNWWxHVFB
Vb3ZNTkl2Q0FcIiwgXCJ2XCI6IFwiKzEtMjAyLTU1NS0wMTAxXCJ9IiwgImFkZHJlc3MiO
iAie1wic1wiOiBcIjViUHMxSXF1Wk5hMGhrYUZ6enpaTndcIiwgXCJ2XCI6IHtcInN0cmV
ldF9hZGRyZXNzXCI6IFwiMTIzIE1haW4gU3RcIiwgXCJsb2NhbGl0eVwiOiBcIkFueXRvd
25cIiwgXCJyZWdpb25cIjogXCJBbnlzdGF0ZVwiLCBcImNvdW50cnlcIjogXCJVU1wifX0
iLCAiYmlydGhkYXRlIjogIntcInNcIjogXCJ5MXNWVTV3ZGZKYWhWZGd3UGdTN1JRXCIsI
FwidlwiOiBcIjE5NDAtMDEtMDFcIn0ifX0
</pre><a href="#section-5.6-4" class="pilcrow">¶</a>
</div>
</div>
<p id="section-5.6-5">(Line breaks for presentation only.)<a href="#section-5.6-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="format-of-an-sd-jwt-release">
<section id="section-5.7">
        <h3 id="name-format-of-an-sd-jwt-release">
<a href="#section-5.7" class="section-number selfRef">5.7. </a><a href="#name-format-of-an-sd-jwt-release" class="section-name selfRef">Format of an SD-JWT Release</a>
        </h3>
<p id="section-5.7-1">SD-JWT-R contains claim values and the salts of the claims that the holder
has consented to release to the Verifier. This enables the Verifier to verify
the claims received from the holder by computing the hash digests of the claim
values and the salts revealed in the SD-JWT-R using the hashing algorithm
specified in SD-JWT and comparing them to the hash digests included in SD-JWT.<a href="#section-5.7-1" class="pilcrow">¶</a></p>
<p id="section-5.7-2">For each claim, an array of the salt and the claim value is contained in the
<code>sd_release</code> object. The structure of an <code>sd_release</code> object in the SD-JWT-R is the same as the structure of an <code>sd_release</code> object in SVC.<a href="#section-5.7-2" class="pilcrow">¶</a></p>
<p id="section-5.7-3">The SD-JWT-R MAY contain further claims, for example, to ensure a binding
to a concrete transaction (in the example the <code>nonce</code> and <code>aud</code> claims).<a href="#section-5.7-3" class="pilcrow">¶</a></p>
<p id="section-5.7-4">When the holder sends the SD-JWT-R to the Verifier, the SD-JWT-R MUST be a JWS
represented as the JWS Compact Serialization as described in
Section 7.1 of <span>[<a href="#RFC7515" class="xref">RFC7515</a>]</span>.<a href="#section-5.7-4" class="pilcrow">¶</a></p>
<p id="section-5.7-5">If holder binding is desired, the SD-JWT-R is signed by the holder. If no
holder binding is to be used, the <code>none</code> algorithm is used, i.e., the document
is not signed. TODO: Change to plain base64 to avoid alg=none issues<a href="#section-5.7-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="example-sd-jwt-release-for-example-1">
<section id="section-5.8">
        <h3 id="name-example-sd-jwt-release-for-">
<a href="#section-5.8" class="section-number selfRef">5.8. </a><a href="#name-example-sd-jwt-release-for-" class="section-name selfRef">Example: SD-JWT Release for Example 1</a>
        </h3>
<p id="section-5.8-1">The following is a non-normative example of the contents of an SD-JWT-R for Example 1:<a href="#section-5.8-1" class="pilcrow">¶</a></p>
<div id="example-simple-sd_jwt_release_payload">
<div id="section-5.8-2">
<pre class="sourcecode lang-json">{
  "nonce": "XZOUco1u_gEPknxS78sWWg",
  "aud": "https://example.com/verifier",
  "sd_release": {
    "given_name": "{\"s\": \"6Ij7tM-a5iVPGboS5tmvVA\", \"v\": \"John\"}",
    "family_name": "{\"s\": \"Qg_O64zqAxe412a108iroA\", \"v\": \"Doe\"}",
    "address": "{\"s\": \"5bPs1IquZNa0hkaFzzzZNw\", \"v\": {\"street_address\": \"123 Main St\", \"locality\": \"Anytown\", \"region\": \"Anystate\", \"country\": \"US\"}}"
  }
}
</pre><a href="#section-5.8-2" class="pilcrow">¶</a>
</div>
</div>
<p id="section-5.8-3">For each claim, a JSON literal that decodes to an object with the and the claim
value (plus optionally the claim name) is contained in the <code>sd_release</code> object.<a href="#section-5.8-3" class="pilcrow">¶</a></p>
<p id="section-5.8-4">Again, the SD-JWT-R follows the same structure as the <code>sd_digests</code> in the SD-JWT.<a href="#section-5.8-4" class="pilcrow">¶</a></p>
<p id="section-5.8-5">Below is a non-normative example of a representation of the SD-JWT-R JWS Compact
Serialization:<a href="#section-5.8-5" class="pilcrow">¶</a></p>
<div id="example-simple-serialized_sd_jwt_release">
<div class="artwork art-text alignLeft" id="section-5.8-6">
<pre>eyJhbGciOiAiUlMyNTYiLCAia2lkIjogIkxkeVRYd0F5ZnJpcjRfVjZORzFSYzEwVThKZE
xZVHJFQktKaF9oNWlfclUifQ.eyJub25jZSI6ICJYWk9VY28xdV9nRVBrbnhTNzhzV1dnI
iwgImF1ZCI6ICJodHRwczovL2V4YW1wbGUuY29tL3ZlcmlmaWVyIiwgInNkX3JlbGVhc2U
iOiB7ImdpdmVuX25hbWUiOiAie1wic1wiOiBcIjZJajd0TS1hNWlWUEdib1M1dG12VkFcI
iwgXCJ2XCI6IFwiSm9oblwifSIsICJmYW1pbHlfbmFtZSI6ICJ7XCJzXCI6IFwiUWdfTzY
0enFBeGU0MTJhMTA4aXJvQVwiLCBcInZcIjogXCJEb2VcIn0iLCAiYWRkcmVzcyI6ICJ7X
CJzXCI6IFwiNWJQczFJcXVaTmEwaGthRnp6elpOd1wiLCBcInZcIjoge1wic3RyZWV0X2F
kZHJlc3NcIjogXCIxMjMgTWFpbiBTdFwiLCBcImxvY2FsaXR5XCI6IFwiQW55dG93blwiL
CBcInJlZ2lvblwiOiBcIkFueXN0YXRlXCIsIFwiY291bnRyeVwiOiBcIlVTXCJ9fSJ9fQ.
fw4xRl7m1mDPCZvCTn3GOr2PgBZ--fTKfy7s-GuEifNvzW5KsJaBBFvzdZztm25XGhk29u
w-XwEw00r0hyxXLBvWfA0XbDK3JBmdpOSW1bEyNBdSHPJoeq9Xyts2JN40vJzU2UxNaLKD
aEheWf3F_E52yhHxvMLNdvZJ9FksJdSMK6ZCyGfRJadPN2GhNltqph52sWiFKUyUk_4Rtw
XmT_lF49tWOMZqtG-akN9wrBoMsleM0soA0BXIK10rG5cKZoSNr-u2luzbdZx3CFdAenaq
ScIkluPPcrXBZGYyX2zYUbGQs2RRXnBmox_yl6CvLbb0qTTYhDnDEo_MH-ZtWw
</pre><a href="#section-5.8-6" class="pilcrow">¶</a>
</div>
</div>
<p id="section-5.8-7">(Line breaks for presentation only.)<a href="#section-5.8-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sending-sd-jwt-and-sd-jwt-r-during-presentation">
<section id="section-5.9">
        <h3 id="name-sending-sd-jwt-and-sd-jwt-r">
<a href="#section-5.9" class="section-number selfRef">5.9. </a><a href="#name-sending-sd-jwt-and-sd-jwt-r" class="section-name selfRef">Sending SD-JWT and SD-JWT-R during Presentation</a>
        </h3>
<p id="section-5.9-1">The SD-JWT and the SD-JWT-R can be combined into one document using period character <code>.</code> as a separator (here for Example 1):<a href="#section-5.9-1" class="pilcrow">¶</a></p>
<div id="example-simple-combined_sd_jwt_sd_jwt_release">
<div class="artwork art-text alignLeft" id="section-5.9-2">
<pre>eyJhbGciOiAiUlMyNTYiLCAia2lkIjogImNBRUlVcUowY21MekQxa3pHemhlaUJhZzBZUk
F6VmRsZnhOMjgwTmdIYUEifQ.eyJpc3MiOiAiaHR0cHM6Ly9leGFtcGxlLmNvbS9pc3N1Z
XIiLCAiY25mIjogeyJqd2siOiB7Imt0eSI6ICJSU0EiLCAibiI6ICJwbTRiT0hCZy1vWWh
BeVBXelI1NkFXWDNyVUlYcDExX0lDRGtHZ1M2VzNaV0x0cy1oendJM3g2NTY1OWtnNGhWb
zlkYkdvQ0pFM1pHRl9lYWV0RTMwVWhCVUVncEd3ckRyUWlKOXpxcHJtY0ZmcjNxdnZrR2p
0dGg4WmdsMWVNMmJKY093RTdQQ0JIV1RLV1lzMTUyUjdnNkpnMk9WcGgtYThycS1xNzlNa
EtHNVFvV19tVHoxMFFUXzZINGM3UGpXRzFmamg4aHBXTm5iUF9wdjZkMXpTd1pmYzVmbDZ
5VlJMMERWMFYzbEdIS2UyV3FmX2VOR2pCckJMVmtsRFRrOC1zdFhfTVdMY1ItRUdtWEFPd
jBVQldpdFNfZFhKS0p1LXZYSnl3MTRuSFNHdXhUSUsyaHgxcHR0TWZ0OUNzdnFpbVhLZUR
UVTE0cVFMMWVFN2loY3ciLCAiZSI6ICJBUUFCIn19LCAiaWF0IjogMTUxNjIzOTAyMiwgI
mV4cCI6IDE1MTYyNDcwMjIsICJzZF9oYXNoX2FsZyI6ICJzaGEtMjU2IiwgInNkX2RpZ2V
zdHMiOiB7InN1YiI6ICJPTWR3a2sySFB1aUluUHlwV1VXTXhvdDFZMnRTdEdzTHVJY0RNa
ktkWE1VIiwgImdpdmVuX25hbWUiOiAiQWZLS0g0YTBJWmtpOE1GRHl0aEZhRlNfWHF6bi1
3UnZBTWZpeV9WallwRSIsICJmYW1pbHlfbmFtZSI6ICJlVW1YbXJ5MzJKaUtfNzZ4TWFzY
WdrQVFRc21TVmRXNTdBamsxOHJpU0YwIiwgImVtYWlsIjogIi1SY3I0ZkR5andsTV9pdGN
NeG9RWkNFMVFBRXd5TEpjaWJFcEgxMTRLaUUiLCAicGhvbmVfbnVtYmVyIjogIkp2Mm53M
EMxd1A1QVN1dFlOQXhyV0VuYURSSXBpRjBlVFVBa1VPcDhGNlkiLCAiYWRkcmVzcyI6ICJ
acmpLcy1SbUVBVmVBWVN6U3c2R1BGck1wY2djdENmYUo2dDlxUWhiZko0IiwgImJpcnRoZ
GF0ZSI6ICJxWFBSUlBkcE5hZWJQOGp0YkVwTy1za0Y0bjd2N0FTVGg4b0xnMG1rQWRRIn1
9.QgoJn9wkjFvM9bAr0hTDHLspuqdA21WzfBRVHkASa2ck4PFD3TC9MiZSi3AiRytRbYT4
ZzvkH3BSbm6vy68y62gj0A6OYvZ1Z60Wxho14bxZQveJZgw3u_lMvYj6GKiUtskypFEHU-
Kd-LoDVqEpf6lPQHdpsac__yQ_JL24oCEBlVQRXB-T-6ZNZfID6JafSkNNCYQbI8nXbzIE
p1LBFm0fE8eUd4G4yPYOj1SeuR6Gy92T0vAoL5QtpIAHo49oAmiSIj6DQNl2cNYs74jhrB
IcNZyt4l8H1lV20wS5OS3T0vXaYD13fgm0p4iWD9cVg3HKShUVulEyrSbq94jIKg.eyJhb
GciOiAiUlMyNTYiLCAia2lkIjogIkxkeVRYd0F5ZnJpcjRfVjZORzFSYzEwVThKZExZVHJ
FQktKaF9oNWlfclUifQ.eyJub25jZSI6ICJYWk9VY28xdV9nRVBrbnhTNzhzV1dnIiwgIm
F1ZCI6ICJodHRwczovL2V4YW1wbGUuY29tL3ZlcmlmaWVyIiwgInNkX3JlbGVhc2UiOiB7
ImdpdmVuX25hbWUiOiAie1wic1wiOiBcIjZJajd0TS1hNWlWUEdib1M1dG12VkFcIiwgXC
J2XCI6IFwiSm9oblwifSIsICJmYW1pbHlfbmFtZSI6ICJ7XCJzXCI6IFwiUWdfTzY0enFB
eGU0MTJhMTA4aXJvQVwiLCBcInZcIjogXCJEb2VcIn0iLCAiYWRkcmVzcyI6ICJ7XCJzXC
I6IFwiNWJQczFJcXVaTmEwaGthRnp6elpOd1wiLCBcInZcIjoge1wic3RyZWV0X2FkZHJl
c3NcIjogXCIxMjMgTWFpbiBTdFwiLCBcImxvY2FsaXR5XCI6IFwiQW55dG93blwiLCBcIn
JlZ2lvblwiOiBcIkFueXN0YXRlXCIsIFwiY291bnRyeVwiOiBcIlVTXCJ9fSJ9fQ.fw4xR
l7m1mDPCZvCTn3GOr2PgBZ--fTKfy7s-GuEifNvzW5KsJaBBFvzdZztm25XGhk29uw-XwE
w00r0hyxXLBvWfA0XbDK3JBmdpOSW1bEyNBdSHPJoeq9Xyts2JN40vJzU2UxNaLKDaEheW
f3F_E52yhHxvMLNdvZJ9FksJdSMK6ZCyGfRJadPN2GhNltqph52sWiFKUyUk_4RtwXmT_l
F49tWOMZqtG-akN9wrBoMsleM0soA0BXIK10rG5cKZoSNr-u2luzbdZx3CFdAenaqScIkl
uPPcrXBZGYyX2zYUbGQs2RRXnBmox_yl6CvLbb0qTTYhDnDEo_MH-ZtWw
</pre><a href="#section-5.9-2" class="pilcrow">¶</a>
</div>
</div>
<p id="section-5.9-3">(Line breaks for presentation only.)<a href="#section-5.9-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="verification-and-processing">
<section id="section-6">
      <h2 id="name-verification-and-processing">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-verification-and-processing" class="section-name selfRef">Verification and Processing</a>
      </h2>
<div id="verification-by-the-holder-when-receiving-sd-jwt-and-svc">
<section id="section-6.1">
        <h3 id="name-verification-by-the-holder-">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-verification-by-the-holder-" class="section-name selfRef">Verification by the Holder when Receiving SD-JWT and SVC</a>
        </h3>
<p id="section-6.1-1">The holder SHOULD verify the binding between SD-JWT and SVC by performing the following steps:
 1. Check that all the claims in the SVC are present in the SD-JWT and that there are no claims in the SD-JWT that are not in the SVC
 2. Check that the hashes of the claims in the SVC match those in the SD-JWT<a href="#section-6.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="verification-by-the-verifier-when-receiving-sd-jwt-and-sd-jwt-r">
<section id="section-6.2">
        <h3 id="name-verification-by-the-verifie">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-verification-by-the-verifie" class="section-name selfRef">Verification by the Verifier when Receiving SD-JWT and SD-JWT-R</a>
        </h3>
<p id="section-6.2-1">Verifiers MUST follow <span>[<a href="#RFC8725" class="xref">RFC8725</a>]</span> for checking the SD-JWT and, if signed, the
SD-JWT Release.<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<p id="section-6.2-2">Verifiers MUST go through (at least) the following steps before
trusting/using any of the contents of an SD-JWT:<a href="#section-6.2-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-6.2-3">
          <li id="section-6.2-3.1">
            <p id="section-6.2-3.1.1">Determine if holder binding is to be checked for the SD-JWT. Refer to <a href="#holder_binding_security" class="xref">Section 7.6</a> for details.<a href="#section-6.2-3.1.1" class="pilcrow">¶</a></p>
</li>
<li id="section-6.2-3.2">
            <p id="section-6.2-3.2.1">Check that the presentation consists of six period-separated (<code>.</code>) elements; if holder binding is not required, the last element can be empty.<a href="#section-6.2-3.2.1" class="pilcrow">¶</a></p>
</li>
<li id="section-6.2-3.3">
            <p id="section-6.2-3.3.1">Separate the SD-JWT from the SD-JWT Release.<a href="#section-6.2-3.3.1" class="pilcrow">¶</a></p>
</li>
<li id="section-6.2-3.4">
            <p id="section-6.2-3.4.1">Validate the SD-JWT:<a href="#section-6.2-3.4.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-6.2-3.4.2">
              <li id="section-6.2-3.4.2.1">
                <p id="section-6.2-3.4.2.1.1">Ensure that a signing algorithm was used that was deemed secure for the application. Refer to <span>[<a href="#RFC8725" class="xref">RFC8725</a>]</span>, Sections 3.1 and 3.2 for details.<a href="#section-6.2-3.4.2.1.1" class="pilcrow">¶</a></p>
</li>
<li id="section-6.2-3.4.2.2">
                <p id="section-6.2-3.4.2.2.1">Validate the signature over the SD-JWT.<a href="#section-6.2-3.4.2.2.1" class="pilcrow">¶</a></p>
</li>
<li id="section-6.2-3.4.2.3">
                <p id="section-6.2-3.4.2.3.1">Validate the issuer of the SD-JWT and that the signing key belongs to this issuer.<a href="#section-6.2-3.4.2.3.1" class="pilcrow">¶</a></p>
</li>
<li id="section-6.2-3.4.2.4">
                <p id="section-6.2-3.4.2.4.1">Check that the SD-JWT is valid using <code>nbf</code>, <code>iat</code>, and <code>exp</code> claims, if provided in the SD-JWT.<a href="#section-6.2-3.4.2.4.1" class="pilcrow">¶</a></p>
</li>
<li id="section-6.2-3.4.2.5">
                <p id="section-6.2-3.4.2.5.1">Check that the claim <code>sd_digests</code> is present in the SD-JWT.<a href="#section-6.2-3.4.2.5.1" class="pilcrow">¶</a></p>
</li>
<li id="section-6.2-3.4.2.6">
                <p id="section-6.2-3.4.2.6.1">Check that the <code>sd_hash_alg</code> claim is present and its value is understand
and the hash algorithm is deemed secure.<a href="#section-6.2-3.4.2.6.1" class="pilcrow">¶</a></p>
</li>
</ol>
</li>
<li id="section-6.2-3.5">
            <p id="section-6.2-3.5.1">Validate the SD-JWT Release:<a href="#section-6.2-3.5.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-6.2-3.5.2">
              <li id="section-6.2-3.5.2.1">
                <p id="section-6.2-3.5.2.1.1">If holder binding is required, validate the signature over the SD-JWT using the same steps as for the SD-JWT plus the following steps:<a href="#section-6.2-3.5.2.1.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-6.2-3.5.2.1.2">
                  <li id="section-6.2-3.5.2.1.2.1">
                    <p id="section-6.2-3.5.2.1.2.1.1">Determine that the public key for the private key that used to sign the SD-JWT-R is bound to the SD-JWT, i.e., the SD-JWT either contains a reference to the public key or contains the public key itself.<a href="#section-6.2-3.5.2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
<li id="section-6.2-3.5.2.1.2.2">
                    <p id="section-6.2-3.5.2.1.2.2.1">Determine that the SD-JWT-R is bound to the current transaction and was created for this verifier (replay protection). This is usually achieved by a <code>nonce</code> and <code>aud</code> field within the SD-JWT Release.<a href="#section-6.2-3.5.2.1.2.2.1" class="pilcrow">¶</a></p>
</li>
</ol>
</li>
<li id="section-6.2-3.5.2.2">
                <p id="section-6.2-3.5.2.2.1">For each claim in the SD-JWT Release:<a href="#section-6.2-3.5.2.2.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-6.2-3.5.2.2.2">
                  <li id="section-6.2-3.5.2.2.2.1">
                    <p id="section-6.2-3.5.2.2.2.1.1">Ensure that the claim is present as well in <code>sd_release</code> in the SD-JWT.
If <code>sd_release</code> is structured, the claim MUST be present at the same
place within the structure.<a href="#section-6.2-3.5.2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
<li id="section-6.2-3.5.2.2.2.2">
                    <p id="section-6.2-3.5.2.2.2.2.1">Compute the base64url-encoded hash digest of the JSON literal released
by the Holder using the <code>sd_hash_alg</code> in SD-JWT.<a href="#section-6.2-3.5.2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
<li id="section-6.2-3.5.2.2.2.3">
                    <p id="section-6.2-3.5.2.2.2.3.1">Compare the hash digests computed in the previous step with the one of
the same claim in the SD-JWT. Accept the claim only when the two hash
digests match.<a href="#section-6.2-3.5.2.2.2.3.1" class="pilcrow">¶</a></p>
</li>
<li id="section-6.2-3.5.2.2.2.4">
                    <p id="section-6.2-3.5.2.2.2.4.1">Ensure that the claim value in the SD-JWT-R is a JSON-encoded
object containing at least the keys <code>s</code> and <code>v</code>, and optionally <code>n</code>.<a href="#section-6.2-3.5.2.2.2.4.1" class="pilcrow">¶</a></p>
</li>
<li id="section-6.2-3.5.2.2.2.5">
                    <p id="section-6.2-3.5.2.2.2.5.1">Store the value of the key <code>v</code> as the claim value. If <code>n</code> is contained
in the object, use the value of the key <code>n</code> as the claim name.<a href="#section-6.2-3.5.2.2.2.5.1" class="pilcrow">¶</a></p>
</li>
</ol>
</li>
<li id="section-6.2-3.5.2.3">
                <p id="section-6.2-3.5.2.3.1">Once all necessary claims have been verified, their values can be
validated and used according to the requirements of the application. It
MUST be ensured that all claims required for the application have been
released.<a href="#section-6.2-3.5.2.3.1" class="pilcrow">¶</a></p>
</li>
</ol>
</li>
</ol>
<p id="section-6.2-4">If any step fails, the input is not valid and processing MUST be aborted.<a href="#section-6.2-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="processing_model">
<section id="section-6.3">
        <h3 id="name-processing-model">
<a href="#section-6.3" class="section-number selfRef">6.3. </a><a href="#name-processing-model" class="section-name selfRef">Processing Model</a>
        </h3>
<p id="section-6.3-1">Neither an SD-JWT nor an SD-JWT-R is suitable for direct use by an application.
Besides the REQUIRED verification steps listed above, it is further RECOMMENDED
that an application-consumable format is generated from the data released in
the SD-JWT-Release. The RECOMMENDED way is to merge the released claims and any
plaintext claims in the SD-JWT recursively:<a href="#section-6.3-1" class="pilcrow">¶</a></p>
<ul>
<li id="section-6.3-2.1">
            <p id="section-6.3-2.1.1">Objects from the released claims must be merged into existing objects from the SD-JWT.<a href="#section-6.3-2.1.1" class="pilcrow">¶</a></p>
</li>
<li id="section-6.3-2.2">
            <p id="section-6.3-2.2.1">If a key is present in both objects:<a href="#section-6.3-2.2.1" class="pilcrow">¶</a></p>
<ul>
<li id="section-6.3-2.2.2.1">
                <p id="section-6.3-2.2.2.1.1">If the value in the released claims is and object and the value in the
SD-JWT claims is an object, the two objects MUST be merged recursively.<a href="#section-6.3-2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
<li id="section-6.3-2.2.2.2">
                <p id="section-6.3-2.2.2.2.1">Else, the value in the released claims MUST be used.<a href="#section-6.3-2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
</ul>
<p id="section-6.3-3">The keys <code>sd_digests</code> and <code>sd_hash_alg</code> SHOULD be removed prior to further
processing.<a href="#section-6.3-3" class="pilcrow">¶</a></p>
<p id="section-6.3-4">An example can be seen in Example 3 in the Appendix.<a href="#section-6.3-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="security_considerations">
<section id="section-7">
      <h2 id="name-security-considerations">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<div id="mandatory-hash-computation-of-the-revealed-claim-values-by-the-verifier">
<section id="section-7.1">
        <h3 id="name-mandatory-hash-computation-">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-mandatory-hash-computation-" class="section-name selfRef">Mandatory hash computation of the revealed claim values by the Verifier</a>
        </h3>
<p id="section-7.1-1">ToDo: add text explaining mechanisms that should be adopted to ensure that
  verifiers validate the claim values received in SD-JWT-R by calculating the
  hashes of those values and comparing them with the hashes in the SD-JWT:
  - create a test suite that forces hash computation by the Verifiers,
    and includes negative test cases in test vectors
  - use only implementations/libraries that are compliant to the test suite
  - etc.<a href="#section-7.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="mandatory-signing-of-the-sd-jwt">
<section id="section-7.2">
        <h3 id="name-mandatory-signing-of-the-sd">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-mandatory-signing-of-the-sd" class="section-name selfRef">Mandatory signing of the SD-JWT</a>
        </h3>
<p id="section-7.2-1">The SD-JWT MUST be signed by the issuer to protect integrity of the issued
claims. An attacker can modify or add claims if an SD-JWT is not signed (e.g.,
change the "email" attribute to take over the victim's account or add an
attribute indicating a fake academic qualification).<a href="#section-7.2-1" class="pilcrow">¶</a></p>
<p id="section-7.2-2">The verifier MUST always check the SD-JWT signature to ensure that the SD-JWT
has not been tampered with since its issuance. If the signature on the SD-JWT
cannot be verified, the SD-JWT MUST be rejected.<a href="#section-7.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="entropy-and-uniqueness-of-the-salt">
<section id="section-7.3">
        <h3 id="name-entropy-and-uniqueness-of-t">
<a href="#section-7.3" class="section-number selfRef">7.3. </a><a href="#name-entropy-and-uniqueness-of-t" class="section-name selfRef">Entropy and Uniqueness of the salt</a>
        </h3>
<p id="section-7.3-1">The security model relies on the fact that the salt is not learned or guessed by
the attacker. It is vitally important to adhere to this principle. As such, the
salt MUST be created in such a manner that it is cryptographically random,
long enough and has high entropy that it is not practical for the attacker to
guess. Each salt value MUST be unique.<a href="#section-7.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="minimum-length-of-the-salt">
<section id="section-7.4">
        <h3 id="name-minimum-length-of-the-salt">
<a href="#section-7.4" class="section-number selfRef">7.4. </a><a href="#name-minimum-length-of-the-salt" class="section-name selfRef">Minimum length of the salt</a>
        </h3>
<p id="section-7.4-1">The length of the randomly-generated portion of the salt MUST be at least 128 bits.<a href="#section-7.4-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="choice-of-a-hash-function">
<section id="section-7.5">
        <h3 id="name-choice-of-a-hash-function">
<a href="#section-7.5" class="section-number selfRef">7.5. </a><a href="#name-choice-of-a-hash-function" class="section-name selfRef">Choice of a hash function</a>
        </h3>
<p id="section-7.5-1">For the security of this scheme, the hash function is required to be preimage and collision
resistant, i.e., it is infeasible to calculate the salt and claim value that result in
a particular digest, and it is infeasible to find a different salt and claim value pair that
result in a matching digest, respectively.<a href="#section-7.5-1" class="pilcrow">¶</a></p>
<p id="section-7.5-2">Furthermore the hash algorithms MD2, MD4, MD5, RIPEMD-160, and SHA-1
revealed fundamental weaknesses and they MUST NOT be used.<a href="#section-7.5-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="holder_binding_security">
<section id="section-7.6">
        <h3 id="name-holder-binding">
<a href="#section-7.6" class="section-number selfRef">7.6. </a><a href="#name-holder-binding" class="section-name selfRef">Holder Binding</a>
        </h3>
<p id="section-7.6-1">TBD<a href="#section-7.6-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="blinding-claim-names">
<section id="section-7.7">
        <h3 id="name-blinding-claim-names">
<a href="#section-7.7" class="section-number selfRef">7.7. </a><a href="#name-blinding-claim-names" class="section-name selfRef">Blinding Claim Names</a>
        </h3>
<p id="section-7.7-1">Issuers that chose to blind claim names MUST ensure not to inadvertently leak
information about the blinded claim names to verifiers. In particular, issuers
MUST choose placeholder claim names accordingly. It is RECOMMENDED to use
cryptographically random values with at least 128 bits of entropy as placeholder
claim names.<a href="#section-7.7-1" class="pilcrow">¶</a></p>
<p id="section-7.7-2">The order of elements in JSON-encoded objects is not relevant to applications,
but the order may reveal information about the blinded claim name to the
verifier. It is therefore RECOMMENDED to ensure that the order is shuffled or
otherwise hidden (e.g., alphabetically ordered using the blinded claim names).<a href="#section-7.7-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="privacy_considerations">
<section id="section-8">
      <h2 id="name-privacy-considerations">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-privacy-considerations" class="section-name selfRef">Privacy Considerations</a>
      </h2>
<div id="claim-names">
<section id="section-8.1">
        <h3 id="name-claim-names">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-claim-names" class="section-name selfRef">Claim Names</a>
        </h3>
<p id="section-8.1-1">By default, claim names are not blinded in an SD-JWT. In this case, even when
the claim's value is not known to a verifier, the claim name can disclose some
information to the verifier. For example, if the SD-JWT contains a claim named
<code>super_secret_club_membership_no</code>, the verifier might assume that the end-user
is a member of the Super Secret Club.<a href="#section-8.1-1" class="pilcrow">¶</a></p>
<p id="section-8.1-2">Blinding claim names can help to avoid this potential privacy issue. In many
cases, however, verifiers can already deduce this or similar information just
from the identification of the issuer and the schema used for the SD-JWT.
Blinding claim names might not provide additional privacy if this is the case.<a href="#section-8.1-2" class="pilcrow">¶</a></p>
<p id="section-8.1-3">Furthermore, re-using the same value to blind a claim name may limit the privacy benefits.<a href="#section-8.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="unlinkability">
<section id="section-8.2">
        <h3 id="name-unlinkability">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-unlinkability" class="section-name selfRef">Unlinkability</a>
        </h3>
<p id="section-8.2-1">Colluding issuer/verifier or verifier/verifier pairs could link issuance/presentation or two presentation sessions
to the same user on the basis of unique values encoded in the SD-JWT
(issuer signature, salts, digests, etc.). More advanced cryptographic schemes, outside the scope of
this specification, can be used to prevent this type of linkability.<a href="#section-8.2-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="Acknowledgements">
<section id="section-9">
      <h2 id="name-acknowledgements">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-acknowledgements" class="section-name selfRef">Acknowledgements</a>
      </h2>
<p id="section-9-1">We would like to thank
Alen Horvat,
Brian Campbell,
Christian Paquin,
Fabian Hauck,
Giuseppe De Marco,
Kushal Das,
Mike Jones,
Nat Sakimura,
Pieter Kasselman, and
Torsten Lodderstedt
for their contributions (some of which substantial) to this draft and to the initial set of implementations.<a href="#section-9-1" class="pilcrow">¶</a></p>
<p id="section-9-2">The work on this draft was started at OAuth Security Workshop 2022 in Trondheim, Norway.<a href="#section-9-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="iana_considerations">
<section id="section-10">
      <h2 id="name-iana-considerations">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-10-1">TBD<a href="#section-10-1" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-11">
      <h2 id="name-normative-references">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
      </h2>
<dl class="references">
<dt id="RFC7519">[RFC7519]</dt>
<dd>
<span class="refAuthor">Jones, M.</span><span class="refAuthor">, Bradley, J.</span><span class="refAuthor">, and N. Sakimura</span>, <span class="refTitle">"JSON Web Token (JWT)"</span>, <span class="seriesInfo">RFC 7519</span>, <span class="seriesInfo">DOI 10.17487/RFC7519</span>, <time datetime="2015-05">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7519">https://www.rfc-editor.org/info/rfc7519</a>&gt;</span>. </dd>
<dt id="RFC8174">[RFC8174]</dt>
<dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dt id="RFC8259">[RFC8259]</dt>
<dd>
<span class="refAuthor">Bray, T., Ed.</span>, <span class="refTitle">"The JavaScript Object Notation (JSON) Data Interchange Format"</span>, <span class="seriesInfo">STD 90</span>, <span class="seriesInfo">RFC 8259</span>, <span class="seriesInfo">DOI 10.17487/RFC8259</span>, <time datetime="2017-12">December 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8259">https://www.rfc-editor.org/info/rfc8259</a>&gt;</span>. </dd>
<dt id="RFC7515">[RFC7515]</dt>
<dd>
<span class="refAuthor">Jones, M.</span><span class="refAuthor">, Bradley, J.</span><span class="refAuthor">, and N. Sakimura</span>, <span class="refTitle">"JSON Web Signature (JWS)"</span>, <span class="seriesInfo">RFC 7515</span>, <span class="seriesInfo">DOI 10.17487/RFC7515</span>, <time datetime="2015-05">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7515">https://www.rfc-editor.org/info/rfc7515</a>&gt;</span>. </dd>
<dt id="RFC2119">[RFC2119]</dt>
<dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
</dl>
</section>
<section id="section-12">
      <h2 id="name-informative-references">
<a href="#section-12" class="section-number selfRef">12. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
      </h2>
<dl class="references">
<dt id="RFC8725">[RFC8725]</dt>
<dd>
<span class="refAuthor">Sheffer, Y.</span><span class="refAuthor">, Hardt, D.</span><span class="refAuthor">, and M. Jones</span>, <span class="refTitle">"JSON Web Token Best Current Practices"</span>, <span class="seriesInfo">BCP 225</span>, <span class="seriesInfo">RFC 8725</span>, <span class="seriesInfo">DOI 10.17487/RFC8725</span>, <time datetime="2020-02">February 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8725">https://www.rfc-editor.org/info/rfc8725</a>&gt;</span>. </dd>
<dt id="VC_DATA">[VC_DATA]</dt>
<dd>
<span class="refAuthor">Sporny, M.</span><span class="refAuthor">, Noble, G.</span><span class="refAuthor">, Longley, D.</span><span class="refAuthor">, Burnett, D. C.</span><span class="refAuthor">, Zundel, B.</span><span class="refAuthor">, and D. Chadwick</span>, <span class="refTitle">"Verifiable Credentials Data Model 1.0"</span>, <time datetime="2019-11-19">19 November 2019</time>, <span>&lt;<a href="https://www.w3.org/TR/vc_data">https://www.w3.org/TR/vc_data</a>&gt;</span>. </dd>
<dt id="RFC7800">[RFC7800]</dt>
<dd>
<span class="refAuthor">Jones, M.</span><span class="refAuthor">, Bradley, J.</span><span class="refAuthor">, and H. Tschofenig</span>, <span class="refTitle">"Proof-of-Possession Key Semantics for JSON Web Tokens (JWTs)"</span>, <span class="seriesInfo">RFC 7800</span>, <span class="seriesInfo">DOI 10.17487/RFC7800</span>, <time datetime="2016-04">April 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7800">https://www.rfc-editor.org/info/rfc7800</a>&gt;</span>. </dd>
<dt id="RFC8785">[RFC8785]</dt>
<dd>
<span class="refAuthor">Rundgren, A.</span><span class="refAuthor">, Jordan, B.</span><span class="refAuthor">, and S. Erdtman</span>, <span class="refTitle">"JSON Canonicalization Scheme (JCS)"</span>, <span class="seriesInfo">RFC 8785</span>, <span class="seriesInfo">DOI 10.17487/RFC8785</span>, <time datetime="2020-06">June 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8785">https://www.rfc-editor.org/info/rfc8785</a>&gt;</span>. </dd>
</dl>
</section>
<div id="additional-examples">
<section id="section-appendix.a">
      <h2 id="name-additional-examples">
<a href="#section-appendix.a" class="section-number selfRef">Appendix A. </a><a href="#name-additional-examples" class="section-name selfRef">Additional Examples</a>
      </h2>
<div id="example-2-structured-sd-jwt">
<section id="section-a.1">
        <h2 id="name-example-2-structured-sd-jwt">
<a href="#section-a.1" class="section-number selfRef">A.1. </a><a href="#name-example-2-structured-sd-jwt" class="section-name selfRef">Example 2 - Structured SD-JWT</a>
        </h2>
<p id="section-a.1-1">This non-normative example is based on the same claim values as Example 1, but
this time the issuer decided to create a structured object for the hashes. This
allows for the release of individual members of the address claim separately.<a href="#section-a.1-1" class="pilcrow">¶</a></p>
<div id="example-simple_structured-sd_jwt_payload">
<div id="section-a.1-2">
<pre class="sourcecode lang-json">{
  "iss": "https://example.com/issuer",
  "cnf": {
    "jwk": {
      "kty": "RSA",
      "n": "pm4bOHBg-oYhAyPWzR56AWX3rUIXp11_ICDkGgS6W3ZWLts-hzwI3x65659kg4hVo9dbGoCJE3ZGF_eaetE30UhBUEgpGwrDrQiJ9zqprmcFfr3qvvkGjtth8Zgl1eM2bJcOwE7PCBHWTKWYs152R7g6Jg2OVph-a8rq-q79MhKG5QoW_mTz10QT_6H4c7PjWG1fjh8hpWNnbP_pv6d1zSwZfc5fl6yVRL0DV0V3lGHKe2Wqf_eNGjBrBLVklDTk8-stX_MWLcR-EGmXAOv0UBWitS_dXJKJu-vXJyw14nHSGuxTIK2hx1pttMft9CsvqimXKeDTU14qQL1eE7ihcw",
      "e": "AQAB"
    }
  },
  "iat": 1516239022,
  "exp": 1516247022,
  "sd_hash_alg": "sha-256",
  "sd_digests": {
    "sub": "OMdwkk2HPuiInPypWUWMxot1Y2tStGsLuIcDMjKdXMU",
    "given_name": "AfKKH4a0IZki8MFDythFaFS_Xqzn-wRvAMfiy_VjYpE",
    "family_name": "eUmXmry32JiK_76xMasagkAQQsmSVdW57Ajk18riSF0",
    "email": "-Rcr4fDyjwlM_itcMxoQZCE1QAEwyLJcibEpH114KiE",
    "phone_number": "Jv2nw0C1wP5ASutYNAxrWEnaDRIpiF0eTUAkUOp8F6Y",
    "address": {
      "street_address": "n25N6kth9N0CwjZXHeth1gfovg8_I8fGyzeY0qeLp0k",
      "locality": "gJVL_TKoT_SbA4_sv0klLTkg-YEGzVUkC-6egxegsz0",
      "region": "zXbstGPuPq2cPJfyD_-HlmqVyFMf03xH-FbeotXxdbo",
      "country": "pN-5CZ5hbumsPvLKUADm4Ott6gu0E4xj09s4Z51yb8U"
    },
    "birthdate": "UxsvgkUgPnawP6wY4hmxJ_jqiNNKni62zrX7hQOUsys"
  }
}
</pre><a href="#section-a.1-2" class="pilcrow">¶</a>
</div>
</div>
<p id="section-a.1-3">The SVC for this SD-JWT is as follows:<a href="#section-a.1-3" class="pilcrow">¶</a></p>
<div id="example-simple_structured-svc_payload">
<div id="section-a.1-4">
<pre class="sourcecode lang-json">{
  "sd_release": {
    "sub": "{\"s\": \"2GLC42sKQveCfGfryNRN9w\", \"v\": \"6c5c0a49-b589-431d-bae7-219122a9ec2c\"}",
    "given_name": "{\"s\": \"6Ij7tM-a5iVPGboS5tmvVA\", \"v\": \"John\"}",
    "family_name": "{\"s\": \"Qg_O64zqAxe412a108iroA\", \"v\": \"Doe\"}",
    "email": "{\"s\": \"Pc33JM2LchcU_lHggv_ufQ\", \"v\": \"johndoe@example.com\"}",
    "phone_number": "{\"s\": \"lklxF5jMYlGTPUovMNIvCA\", \"v\": \"+1-202-555-0101\"}",
    "address": {
      "street_address": "{\"s\": \"5bPs1IquZNa0hkaFzzzZNw\", \"v\": \"123 Main St\"}",
      "locality": "{\"s\": \"y1sVU5wdfJahVdgwPgS7RQ\", \"v\": \"Anytown\"}",
      "region": "{\"s\": \"C9GSoujviJquEgYfojCb1A\", \"v\": \"Anystate\"}",
      "country": "{\"s\": \"H3o1uswP760Fi2yeGdVCEQ\", \"v\": \"US\"}"
    },
    "birthdate": "{\"s\": \"M0Jb57t41ubrkSuyrDT3xA\", \"v\": \"1940-01-01\"}"
  }
}
</pre><a href="#section-a.1-4" class="pilcrow">¶</a>
</div>
</div>
<p id="section-a.1-5">An SD-JWT-R for the SD-JWT above that discloses only <code>region</code> and <code>country</code> of
the <code>address</code> property:<a href="#section-a.1-5" class="pilcrow">¶</a></p>
<div id="example-simple_structured-sd_jwt_release_payload">
<div id="section-a.1-6">
<pre class="sourcecode lang-json">{
  "nonce": "XZOUco1u_gEPknxS78sWWg",
  "aud": "https://example.com/verifier",
  "sd_release": {
    "given_name": "{\"s\": \"6Ij7tM-a5iVPGboS5tmvVA\", \"v\": \"John\"}",
    "family_name": "{\"s\": \"Qg_O64zqAxe412a108iroA\", \"v\": \"Doe\"}",
    "birthdate": "{\"s\": \"M0Jb57t41ubrkSuyrDT3xA\", \"v\": \"1940-01-01\"}",
    "address": {
      "region": "{\"s\": \"C9GSoujviJquEgYfojCb1A\", \"v\": \"Anystate\"}",
      "country": "{\"s\": \"H3o1uswP760Fi2yeGdVCEQ\", \"v\": \"US\"}"
    }
  }
}
</pre><a href="#section-a.1-6" class="pilcrow">¶</a>
</div>
</div>
</section>
</div>
<div id="example-3-complex-structured-sd-jwt">
<section id="section-a.2">
        <h2 id="name-example-3-complex-structure">
<a href="#section-a.2" class="section-number selfRef">A.2. </a><a href="#name-example-3-complex-structure" class="section-name selfRef">Example 3 - Complex Structured SD-JWT</a>
        </h2>
<p id="section-a.2-1">In this example, a complex object such as those used for OIDC4IDA (todo reference) is used.<a href="#section-a.2-1" class="pilcrow">¶</a></p>
<p id="section-a.2-2">In this example, the Issuer is using a following object as a set of selective disclosure claims to issue to the Holder:<a href="#section-a.2-2" class="pilcrow">¶</a></p>
<div id="example-complex-user_claims">
<div id="section-a.2-3">
<pre class="sourcecode lang-json">{
  "verified_claims": {
    "verification": {
      "trust_framework": "de_aml",
      "time": "2012-04-23T18:25Z",
      "verification_process": "f24c6f-6d3f-4ec5-973e-b0d8506f3bc7",
      "evidence": [
        {
          "type": "document",
          "method": "pipp",
          "time": "2012-04-22T11:30Z",
          "document": {
            "type": "idcard",
            "issuer": {
              "name": "Stadt Augsburg",
              "country": "DE"
            },
            "number": "53554554",
            "date_of_issuance": "2010-03-23",
            "date_of_expiry": "2020-03-22"
          }
        }
      ]
    },
    "claims": {
      "given_name": "Max",
      "family_name": "Meier",
      "nationalities": [
        "DE"
      ],
      "address": {
        "locality": "Maxstadt",
        "postal_code": "12344",
        "country": "DE",
        "street_address": "An der Weide 22"
      }
    }
  },
  "birth_middle_name": "Timotheus",
  "salutation": "Dr.",
  "msisdn": "49123456789"
}
</pre><a href="#section-a.2-3" class="pilcrow">¶</a>
</div>
</div>
<p id="section-a.2-4">The issuer in this example further adds the two claims <code>birthdate</code> and <code>place_of_birth</code> to the <code>claims</code> element in plain text. The following shows the resulting SD-JWT payload:<a href="#section-a.2-4" class="pilcrow">¶</a></p>
<div id="example-complex-sd_jwt_payload">
<div id="section-a.2-5">
<pre class="sourcecode lang-json">{
  "iss": "https://example.com/issuer",
  "cnf": {
    "jwk": {
      "kty": "RSA",
      "n": "pm4bOHBg-oYhAyPWzR56AWX3rUIXp11_ICDkGgS6W3ZWLts-hzwI3x65659kg4hVo9dbGoCJE3ZGF_eaetE30UhBUEgpGwrDrQiJ9zqprmcFfr3qvvkGjtth8Zgl1eM2bJcOwE7PCBHWTKWYs152R7g6Jg2OVph-a8rq-q79MhKG5QoW_mTz10QT_6H4c7PjWG1fjh8hpWNnbP_pv6d1zSwZfc5fl6yVRL0DV0V3lGHKe2Wqf_eNGjBrBLVklDTk8-stX_MWLcR-EGmXAOv0UBWitS_dXJKJu-vXJyw14nHSGuxTIK2hx1pttMft9CsvqimXKeDTU14qQL1eE7ihcw",
      "e": "AQAB"
    }
  },
  "iat": 1516239022,
  "exp": 1516247022,
  "sd_hash_alg": "sha-256",
  "sd_digests": {
    "verified_claims": {
      "verification": {
        "trust_framework": "T7ivxsfuy-nAuECeh0utPEX8cSlc7QflJDE0RqtWDMU",
        "time": "_ecCQoXSR8t9esur66ZwWwC6u4xLuVELjmwFgpRZqcQ",
        "verification_process": "BolwKKvU8N7uUhjN2aGH2T54wjXpkcOz5sC9PkIP4s4",
        "evidence": [
          {
            "type": "7jBlUZkZn1Gfj9mybqlJGzTb2z8KcNNHU0IV4B8MxOM",
            "method": "BRQgcT09gdBqO-MLTka8d6dlCshZCUNpFgsZoet5I-o",
            "time": "-PVLNSmbkCHLp8S7i077YnHZV0yE8gyKWLpWV2o8FJE",
            "document": {
              "type": "vzDHD-6hQqZ5lSw_7acK1lErxSh3E6dO0zlUYM2hDvw",
              "issuer": {
                "name": "us9T9ufVdSmytSmjrtdN_TUI0ai3_JNM3q-0qx0CXk4",
                "country": "uItKtPRZQBB9v5THHOdi02ALjD0MH0U6jjHDLe91NnY"
              },
              "number": "QNNXwo3siOWdqNivKBnFsD4X8gZxVIgu3tv6dfpZhUc",
              "date_of_issuance": "AYWQphnOlFFN9oSVvtBr_iYCKYlucTi3lsMrXebebgc",
              "date_of_expiry": "JIk-APYHW3qy60rvGyFswDCTMfAbBXZyyrZEn8NsBhU"
            }
          }
        ]
      },
      "claims": {
        "given_name": "hZtT6FZBzxAeByDUkFJTeqTCpTd2cQKx6MDPkGvVCRE",
        "family_name": "5yLYGVxPSfXynhcopbIcrFe0_sMGxv_-6THZAu4eWnU",
        "nationalities": "BxCtneHl-RQoL24tS8AaywfyHpnZSq9tUsNDyrYFLYY",
        "address": {
          "locality": "ah6QI8ceduHKP7uiHbwZ2a2LYkxjibHaoWG3M6x1ip4",
          "postal_code": "Auci5Y0jrp_3ahg_IW_Z-mqBaE9BrrItR6o7ekhEGBo",
          "country": "RAKTJg_m1tcoyGI1O2qgQm4KD2d2abXhU4IS7c6RVjU",
          "street_address": "iKkk1nJHTBKTkEt2TNMkZf69WYkiDYaQL6ZzDZmGO1M"
        }
      }
    },
    "birth_middle_name": "KpRjGCm3uykvCGFIDrVJ7iTMQhWakBmCItHbAa6vnZE",
    "salutation": "IoY5e03e65CUrnaMcRDmPCm0RWPEFE4mVkoCsK86agA",
    "msisdn": "XupJick4P8bxaz20kx_VOwbGU1cgslhAUG6IE-tDjms"
  },
  "verified_claims": {
    "claims": {
      "birthdate": "1956-01-28",
      "place_of_birth": {
        "country": "DE",
        "locality": "Musterstadt"
      }
    }
  }
}
</pre><a href="#section-a.2-5" class="pilcrow">¶</a>
</div>
</div>
<p id="section-a.2-6">The SD-JWT is then signed by the issuer to create a document like the following:<a href="#section-a.2-6" class="pilcrow">¶</a></p>
<div id="example-complex-serialized_sd_jwt">
<div class="artwork art-text alignLeft" id="section-a.2-7">
<pre>eyJhbGciOiAiUlMyNTYiLCAia2lkIjogImNBRUlVcUowY21MekQxa3pHemhlaUJhZzBZUk
F6VmRsZnhOMjgwTmdIYUEifQ.eyJpc3MiOiAiaHR0cHM6Ly9leGFtcGxlLmNvbS9pc3N1Z
XIiLCAiY25mIjogeyJqd2siOiB7Imt0eSI6ICJSU0EiLCAibiI6ICJwbTRiT0hCZy1vWWh
BeVBXelI1NkFXWDNyVUlYcDExX0lDRGtHZ1M2VzNaV0x0cy1oendJM3g2NTY1OWtnNGhWb
zlkYkdvQ0pFM1pHRl9lYWV0RTMwVWhCVUVncEd3ckRyUWlKOXpxcHJtY0ZmcjNxdnZrR2p
0dGg4WmdsMWVNMmJKY093RTdQQ0JIV1RLV1lzMTUyUjdnNkpnMk9WcGgtYThycS1xNzlNa
EtHNVFvV19tVHoxMFFUXzZINGM3UGpXRzFmamg4aHBXTm5iUF9wdjZkMXpTd1pmYzVmbDZ
5VlJMMERWMFYzbEdIS2UyV3FmX2VOR2pCckJMVmtsRFRrOC1zdFhfTVdMY1ItRUdtWEFPd
jBVQldpdFNfZFhKS0p1LXZYSnl3MTRuSFNHdXhUSUsyaHgxcHR0TWZ0OUNzdnFpbVhLZUR
UVTE0cVFMMWVFN2loY3ciLCAiZSI6ICJBUUFCIn19LCAiaWF0IjogMTUxNjIzOTAyMiwgI
mV4cCI6IDE1MTYyNDcwMjIsICJzZF9oYXNoX2FsZyI6ICJzaGEtMjU2IiwgInNkX2RpZ2V
zdHMiOiB7InZlcmlmaWVkX2NsYWltcyI6IHsidmVyaWZpY2F0aW9uIjogeyJ0cnVzdF9mc
mFtZXdvcmsiOiAiVDdpdnhzZnV5LW5BdUVDZWgwdXRQRVg4Y1NsYzdRZmxKREUwUnF0V0R
NVSIsICJ0aW1lIjogIl9lY0NRb1hTUjh0OWVzdXI2Nlp3V3dDNnU0eEx1VkVMam13RmdwU
lpxY1EiLCAidmVyaWZpY2F0aW9uX3Byb2Nlc3MiOiAiQm9sd0tLdlU4Tjd1VWhqTjJhR0g
yVDU0d2pYcGtjT3o1c0M5UGtJUDRzNCIsICJldmlkZW5jZSI6IFt7InR5cGUiOiAiN2pCb
FVaa1puMUdmajlteWJxbEpHelRiMno4S2NOTkhVMElWNEI4TXhPTSIsICJtZXRob2QiOiA
iQlJRZ2NUMDlnZEJxTy1NTFRrYThkNmRsQ3NoWkNVTnBGZ3Nab2V0NUktbyIsICJ0aW1lI
jogIi1QVkxOU21ia0NITHA4UzdpMDc3WW5IWlYweUU4Z3lLV0xwV1YybzhGSkUiLCAiZG9
jdW1lbnQiOiB7InR5cGUiOiAidnpESEQtNmhRcVo1bFN3XzdhY0sxbEVyeFNoM0U2ZE8we
mxVWU0yaER2dyIsICJpc3N1ZXIiOiB7Im5hbWUiOiAidXM5VDl1ZlZkU215dFNtanJ0ZE5
fVFVJMGFpM19KTk0zcS0wcXgwQ1hrNCIsICJjb3VudHJ5IjogInVJdEt0UFJaUUJCOXY1V
EhIT2RpMDJBTGpEME1IMFU2ampIRExlOTFOblkifSwgIm51bWJlciI6ICJRTk5Yd28zc2l
PV2RxTml2S0JuRnNENFg4Z1p4VklndTN0djZkZnBaaFVjIiwgImRhdGVfb2ZfaXNzdWFuY
2UiOiAiQVlXUXBobk9sRkZOOW9TVnZ0QnJfaVlDS1lsdWNUaTNsc01yWGViZWJnYyIsICJ
kYXRlX29mX2V4cGlyeSI6ICJKSWstQVBZSFczcXk2MHJ2R3lGc3dEQ1RNZkFiQlhaeXlyW
kVuOE5zQmhVIn19XX0sICJjbGFpbXMiOiB7ImdpdmVuX25hbWUiOiAiaFp0VDZGWkJ6eEF
lQnlEVWtGSlRlcVRDcFRkMmNRS3g2TURQa0d2VkNSRSIsICJmYW1pbHlfbmFtZSI6ICI1e
UxZR1Z4UFNmWHluaGNvcGJJY3JGZTBfc01HeHZfLTZUSFpBdTRlV25VIiwgIm5hdGlvbmF
saXRpZXMiOiAiQnhDdG5lSGwtUlFvTDI0dFM4QWF5d2Z5SHBuWlNxOXRVc05EeXJZRkxZW
SIsICJhZGRyZXNzIjogeyJsb2NhbGl0eSI6ICJhaDZRSThjZWR1SEtQN3VpSGJ3WjJhMkx
Za3hqaWJIYW9XRzNNNngxaXA0IiwgInBvc3RhbF9jb2RlIjogIkF1Y2k1WTBqcnBfM2FoZ
19JV19aLW1xQmFFOUJyckl0UjZvN2VraEVHQm8iLCAiY291bnRyeSI6ICJSQUtUSmdfbTF
0Y295R0kxTzJxZ1FtNEtEMmQyYWJYaFU0SVM3YzZSVmpVIiwgInN0cmVldF9hZGRyZXNzI
jogImlLa2sxbkpIVEJLVGtFdDJUTk1rWmY2OVdZa2lEWWFRTDZaekRabUdPMU0ifX19LCA
iYmlydGhfbWlkZGxlX25hbWUiOiAiS3BSakdDbTN1eWt2Q0dGSURyVko3aVRNUWhXYWtCb
UNJdEhiQWE2dm5aRSIsICJzYWx1dGF0aW9uIjogIklvWTVlMDNlNjVDVXJuYU1jUkRtUEN
tMFJXUEVGRTRtVmtvQ3NLODZhZ0EiLCAibXNpc2RuIjogIlh1cEppY2s0UDhieGF6MjBre
F9WT3diR1UxY2dzbGhBVUc2SUUtdERqbXMifSwgInZlcmlmaWVkX2NsYWltcyI6IHsiY2x
haW1zIjogeyJiaXJ0aGRhdGUiOiAiMTk1Ni0wMS0yOCIsICJwbGFjZV9vZl9iaXJ0aCI6I
HsiY291bnRyeSI6ICJERSIsICJsb2NhbGl0eSI6ICJNdXN0ZXJzdGFkdCJ9fX19.h3d682
fP_x2tqYiUR4y2ftsWE8DHOyg0VFY4q9jUAH7yCk7KExyDUBaiyLrFhgFmJHWzkFoggcST
LsvOAM1QB7kgOilwNW8KKtZpSQV2Db7WEmXi-Q2QblSNGVNXAcZMobLnl6j4QJJaW-5xLb
H-6S1Fe2Vw2hn3rQ2VLzPTUZjzCWk3OdLWTI5MlaYr9GleK9ZDErlrCXtfsXRY6M-Smvb8
ZvIDs95vGxsJW-6SbasuonTunzZGdt2WqXFRtXuaCb-Vw9wPXuytHmH_1vuyROhH8ITzqY
bTZ-4H6eS5BLjx8HXWQDk3r-M_g9htP9G3ezhDi3uzLQ2dSAbNqOWiXQ
</pre><a href="#section-a.2-7" class="pilcrow">¶</a>
</div>
</div>
<p id="section-a.2-8">(Line breaks for presentation only.)<a href="#section-a.2-8" class="pilcrow">¶</a></p>
<p id="section-a.2-9">An SD-JWT-R for some of the claims may look as follows:<a href="#section-a.2-9" class="pilcrow">¶</a></p>
<div id="example-complex-sd_jwt_release_payload">
<div id="section-a.2-10">
<pre class="sourcecode lang-json">{
  "nonce": "XZOUco1u_gEPknxS78sWWg",
  "aud": "https://example.com/verifier",
  "sd_release": {
    "verified_claims": {
      "verification": {
        "trust_framework": "{\"s\": \"2GLC42sKQveCfGfryNRN9w\", \"v\": \"de_aml\"}",
        "time": "{\"s\": \"6Ij7tM-a5iVPGboS5tmvVA\", \"v\": \"2012-04-23T18:25Z\"}",
        "evidence": [
          {
            "type": "{\"s\": \"Pc33JM2LchcU_lHggv_ufQ\", \"v\": \"document\"}"
          }
        ]
      },
      "claims": {
        "given_name": "{\"s\": \"4KyR32oIZt-zkWvFqbULKg\", \"v\": \"Max\"}",
        "family_name": "{\"s\": \"flNP1ncMz9Lg-c9qMIz_9g\", \"v\": \"Meier\"}"
      }
    }
  }
}
</pre><a href="#section-a.2-10" class="pilcrow">¶</a>
</div>
</div>
<p id="section-a.2-11">After verifying the SD-JWT and SD-JWT-R, the verifier merges the selectively
disclosed claims into the other data contained in the JWT. The verifier will
then pass the result on to the application for further processing:<a href="#section-a.2-11" class="pilcrow">¶</a></p>
<div id="example-complex-merged">
<div id="section-a.2-12">
<pre class="sourcecode lang-json">{
  "verified_claims": {
    "verification": {
      "trust_framework": "de_aml",
      "time": "2012-04-23T18:25Z",
      "evidence": [
        {
          "type": "document"
        }
      ]
    },
    "claims": {
      "given_name": "Max",
      "family_name": "Meier",
      "birthdate": "1956-01-28",
      "place_of_birth": {
        "country": "DE",
        "locality": "Musterstadt"
      }
    }
  },
  "iss": "https://example.com/issuer",
  "cnf": {
    "jwk": {
      "kty": "RSA",
      "n": "pm4bOHBg-oYhAyPWzR56AWX3rUIXp11_ICDkGgS6W3ZWLts-hzwI3x65659kg4hVo9dbGoCJE3ZGF_eaetE30UhBUEgpGwrDrQiJ9zqprmcFfr3qvvkGjtth8Zgl1eM2bJcOwE7PCBHWTKWYs152R7g6Jg2OVph-a8rq-q79MhKG5QoW_mTz10QT_6H4c7PjWG1fjh8hpWNnbP_pv6d1zSwZfc5fl6yVRL0DV0V3lGHKe2Wqf_eNGjBrBLVklDTk8-stX_MWLcR-EGmXAOv0UBWitS_dXJKJu-vXJyw14nHSGuxTIK2hx1pttMft9CsvqimXKeDTU14qQL1eE7ihcw",
      "e": "AQAB"
    }
  },
  "iat": 1516239022,
  "exp": 1516247022
}
</pre><a href="#section-a.2-12" class="pilcrow">¶</a>
</div>
</div>
</section>
</div>
<div id="example-4-w3c-verifiable-credentials-data-model">
<section id="section-a.3">
        <h2 id="name-example-4-w3c-verifiable-cr">
<a href="#section-a.3" class="section-number selfRef">A.3. </a><a href="#name-example-4-w3c-verifiable-cr" class="section-name selfRef">Example 4 - W3C Verifiable Credentials Data Model</a>
        </h2>
<p id="section-a.3-1">This example illustrates how the artifacts defined in this specification can be
represented using W3C Verifiable Credentials Data Model as defined in
<span>[<a href="#VC_DATA" class="xref">VC_DATA</a>]</span>.<a href="#section-a.3-1" class="pilcrow">¶</a></p>
<p id="section-a.3-2">SD-JWT is equivalent to an issuer-signed W3C Verifiable Credential (VC). SVC is sent alongside a VC.<a href="#section-a.3-2" class="pilcrow">¶</a></p>
<p id="section-a.3-3">SD-JWT-Release is equivalent to a holder-signed W3C Verifiable Presentation (VP).<a href="#section-a.3-3" class="pilcrow">¶</a></p>
<p id="section-a.3-4">SD-JWT-Release as a VP contains a <code>verifiableCredential</code> claim inside a <code>vp</code> claim that is a string array of an SD-JWT as a VC using JWT compact serialization.<a href="#section-a.3-4" class="pilcrow">¶</a></p>
<p id="section-a.3-5">Below is a non-normative example of an SD-JWT represented as a verifiable credential
encoded as JSON and signed as JWS compliant to <span>[<a href="#VC_DATA" class="xref">VC_DATA</a>]</span>.<a href="#section-a.3-5" class="pilcrow">¶</a></p>
<p id="section-a.3-6">SVC sent alongside this SD-JWT as a JWT-VC is same as in Example 1.<a href="#section-a.3-6" class="pilcrow">¶</a></p>
<div id="section-a.3-7">
<pre class="sourcecode lang-json">{
  "sub": "urn:ietf:params:oauth:jwk-thumbprint:sha-256:NzbLsXh8uDCcd-6MNwXF4W_7noWXFZAfHkxZsRGC9Xs",
  "jti": "http://example.edu/credentials/3732",
  "iss": "https://example.com/keys/foo.jwk",
  "nbf": 1541493724,
  "iat": 1541493724,
  "exp": 1573029723,
  "cnf": {
    "jwk": {
      "kty":"RSA",
      "n": "0vx7agoebGcQSuuPiLJXZptN9nndrQmbXEps2aiAFbWhM78LhWx
     4cbbfAAtVT86zwu1RK7aPFFxuhDR1L6tSoc_BJECPebWKRXjBZCiFV4n3oknjhMs
     tn64tZ_2W-5JsGY4Hc5n9yBXArwl93lqt7_RN5w6Cf0h4QyQ5v-65YGjQR0_FDW2
     QvzqY368QQMicAtaSqzs8KJZgnYb9c7d0zgdAZHzu6qMQvRL5hajrn1n91CbOpbI
     SD08qNLyrdkt-bFTWhAI4vMQFh6WeZu0fM4lFd2NcRwr3XPksINHaQ-G_xBniIqb
     w0Ls1jF44-csFCur-kEgU8awapJzKnqDKgw",
      "e":"AQAB"
    }
  },
  "vc": {
    "@context": [
      "https://www.w3.org/2018/credentials/v1",
      "https://www.w3.org/2018/credentials/examples/v1"
    ],
    "type": [
      "VerifiableCredential",
      "UniversityDegreeCredential"
    ],
    "credentialSubject": {
      "first_name": "Jane",
      "last_name": "Doe"
    }
  },
  "sd_digests": {
    "vc": {
      "credentialSubject": {
        "email": "ET2A1JQLF85ZpBulh6UFstGrSfR4B3KM-bjQVllhxqY",
        "phone_number": "SJnciB2DIRVA5cXBrdKoH6n45788mZyUn2rnv74uMVU",
        "address": "0FldqLfGnERPPVDC17od9xb4w3iRJTEQbW_Yk9AmnDw",
        "birthdate": "-L0kMgIbLXe3OEkKTUGwz_QKhjehDeofKGwoPrxLuo4"
      }
    }
  }
}
</pre><a href="#section-a.3-7" class="pilcrow">¶</a>
</div>
<p id="section-a.3-8">Below is a non-normative example of an SD-JWT-R represented as a verifiable presentation
encoded as JSON and signed as a JWS compliant to <span>[<a href="#VC_DATA" class="xref">VC_DATA</a>]</span>.<a href="#section-a.3-8" class="pilcrow">¶</a></p>
<div id="section-a.3-9">
<pre class="sourcecode lang-json">{
  "alg": "RS256",
  "typ": "JWT",
  "jwk": {
      "kty":"RSA",
      "n": "0vx7agoebGcQSuuPiLJXZptN9nndrQmbXEps2aiAFbWhM78LhWx
     4cbbfAAtVT86zwu1RK7aPFFxuhDR1L6tSoc_BJECPebWKRXjBZCiFV4n3oknjhMs
     tn64tZ_2W-5JsGY4Hc5n9yBXArwl93lqt7_RN5w6Cf0h4QyQ5v-65YGjQR0_FDW2
     QvzqY368QQMicAtaSqzs8KJZgnYb9c7d0zgdAZHzu6qMQvRL5hajrn1n91CbOpbI
     SD08qNLyrdkt-bFTWhAI4vMQFh6WeZu0fM4lFd2NcRwr3XPksINHaQ-G_xBniIqb
     w0Ls1jF44-csFCur-kEgU8awapJzKnqDKgw",
      "e":"AQAB"
    }
}.{
  "iss": "urn:ietf:params:oauth:jwk-thumbprint:sha-256:NzbLsXh8uDCcd-6MNwXF4W_7noWXFZAfHkxZsRGC9Xs",
  "aud": "s6BhdRkqt3",
  "nbf": 1560415047,
  "iat": 1560415047,
  "exp": 1573029723,
  "nonce": "660!6345FSer",
  "vp": {
    "@context": [
      "https://www.w3.org/2018/credentials/v1"
    ],
    "type": [
      "VerifiablePresentation"
    ],
    "verifiableCredential": ["eyJhb...npyXw"]
  },
  "sd_release": {
    "email": "[\"eI8ZWm9QnKPpNPeNenHdhQ\", \"johndoe@example.com\"]",
    "phone_number": "[\"Qg_O64zqAxe412a108iroA\", \"+1-202-555-0101\"]",
    "address": "[\"AJx-095VPrpTtN4QMOqROA\", {\"street_address\": \"123 Main St\", \"locality\": \"Anytown\", \"region\": \"Anystate\", \"country\": \"US\"}]",
    "birthdate": "[\"Pc33JM2LchcU_lHggv_ufQ\", \"1940-01-01\"]"
  }
}
</pre><a href="#section-a.3-9" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="blinding-claim-names-1">
<section id="section-appendix.b">
      <h2 id="name-blinding-claim-names-2">
<a href="#section-appendix.b" class="section-number selfRef">Appendix B. </a><a href="#name-blinding-claim-names-2" class="section-name selfRef">Blinding Claim Names</a>
      </h2>
<div id="example-5-some-blinded-claims">
<section id="section-b.1">
        <h2 id="name-example-5-some-blinded-clai">
<a href="#section-b.1" class="section-number selfRef">B.1. </a><a href="#name-example-5-some-blinded-clai" class="section-name selfRef">Example 5: Some Blinded Claims</a>
        </h2>
<p id="section-b.1-1">The following shows the user information used in this example, included a claim named <code>secret_club_membership_no</code>:<a href="#section-b.1-1" class="pilcrow">¶</a></p>
<div id="example-simple_structured_some_blinded-user_claims">
<div id="section-b.1-2">
<pre class="sourcecode lang-json">{
  "sub": "6c5c0a49-b589-431d-bae7-219122a9ec2c",
  "given_name": "John",
  "family_name": "Doe",
  "email": "johndoe@example.com",
  "phone_number": "+1-202-555-0101",
  "secret_club_membership_no": "23",
  "other_secret_club_membership_no": "42",
  "address": {
    "street_address": "123 Main St",
    "locality": "Anytown",
    "region": "Anystate",
    "country": "US"
  },
  "birthdate": "1940-01-01"
}
</pre><a href="#section-b.1-2" class="pilcrow">¶</a>
</div>
</div>
<p id="section-b.1-3">Hiding just this claim, the following SD-JWT payload would result:<a href="#section-b.1-3" class="pilcrow">¶</a></p>
<div id="example-simple_structured_some_blinded-sd_jwt_payload">
<div id="section-b.1-4">
<pre class="sourcecode lang-json">{
  "iss": "https://example.com/issuer",
  "cnf": {
    "jwk": {
      "kty": "RSA",
      "n": "pm4bOHBg-oYhAyPWzR56AWX3rUIXp11_ICDkGgS6W3ZWLts-hzwI3x65659kg4hVo9dbGoCJE3ZGF_eaetE30UhBUEgpGwrDrQiJ9zqprmcFfr3qvvkGjtth8Zgl1eM2bJcOwE7PCBHWTKWYs152R7g6Jg2OVph-a8rq-q79MhKG5QoW_mTz10QT_6H4c7PjWG1fjh8hpWNnbP_pv6d1zSwZfc5fl6yVRL0DV0V3lGHKe2Wqf_eNGjBrBLVklDTk8-stX_MWLcR-EGmXAOv0UBWitS_dXJKJu-vXJyw14nHSGuxTIK2hx1pttMft9CsvqimXKeDTU14qQL1eE7ihcw",
      "e": "AQAB"
    }
  },
  "iat": 1516239022,
  "exp": 1516247022,
  "sd_hash_alg": "sha-256",
  "sd_digests": {
    "sub": "OMdwkk2HPuiInPypWUWMxot1Y2tStGsLuIcDMjKdXMU",
    "given_name": "AfKKH4a0IZki8MFDythFaFS_Xqzn-wRvAMfiy_VjYpE",
    "family_name": "eUmXmry32JiK_76xMasagkAQQsmSVdW57Ajk18riSF0",
    "email": "-Rcr4fDyjwlM_itcMxoQZCE1QAEwyLJcibEpH114KiE",
    "phone_number": "Jv2nw0C1wP5ASutYNAxrWEnaDRIpiF0eTUAkUOp8F6Y",
    "5a2W0_NrlEZzfqmk_7Pq-w": "gc8VzGTImYRXzP6j7q5RomXt2C_wtsOJ3hAHJdTuEIY",
    "other_secret_club_membership_no": "IirAwgN-MubteYvJ4fmq04p9PnpRTf7hqg0dzSWRboA",
    "address": {
      "street_address": "o_yJIdfhKuKVzOF7i1EuakzC5ghd99CX8_nitm-DsRM",
      "locality": "ogNqsvRqK0-ZPZc9C3Z4_6APvywm-lrm0oF2gcVtl_4",
      "region": "8kFihRLSkEheK0zbEsQ3zKXt8csE6OXJE_jv3032BbU",
      "country": "11IMcoA18LrFSpbysx-uqe7N3I3-QZKwCJqYeQuOUY4"
    },
    "birthdate": "PNtcyxm0Q5PyiBuG4f6eAbK6h4tF2FffwG3xqknZ_5A"
  }
}
</pre><a href="#section-b.1-4" class="pilcrow">¶</a>
</div>
</div>
<p id="section-b.1-5">In the SVC it can be seen that the blinded claim's original name is <code>secret_club_membership_no</code>:<a href="#section-b.1-5" class="pilcrow">¶</a></p>
<div id="example-simple_structured_some_blinded-svc_payload">
<div id="section-b.1-6">
<pre class="sourcecode lang-json">{
  "sd_release": {
    "sub": "{\"s\": \"2GLC42sKQveCfGfryNRN9w\", \"v\": \"6c5c0a49-b589-431d-bae7-219122a9ec2c\"}",
    "given_name": "{\"s\": \"6Ij7tM-a5iVPGboS5tmvVA\", \"v\": \"John\"}",
    "family_name": "{\"s\": \"Qg_O64zqAxe412a108iroA\", \"v\": \"Doe\"}",
    "email": "{\"s\": \"Pc33JM2LchcU_lHggv_ufQ\", \"v\": \"johndoe@example.com\"}",
    "phone_number": "{\"s\": \"lklxF5jMYlGTPUovMNIvCA\", \"v\": \"+1-202-555-0101\"}",
    "5a2W0_NrlEZzfqmk_7Pq-w": "{\"s\": \"5bPs1IquZNa0hkaFzzzZNw\", \"v\": \"23\", \"n\": \"secret_club_membership_no\"}",
    "other_secret_club_membership_no": "{\"s\": \"y1sVU5wdfJahVdgwPgS7RQ\", \"v\": \"42\"}",
    "address": {
      "street_address": "{\"s\": \"C9GSoujviJquEgYfojCb1A\", \"v\": \"123 Main St\"}",
      "locality": "{\"s\": \"H3o1uswP760Fi2yeGdVCEQ\", \"v\": \"Anytown\"}",
      "region": "{\"s\": \"M0Jb57t41ubrkSuyrDT3xA\", \"v\": \"Anystate\"}",
      "country": "{\"s\": \"eK5o5pHfgupPpltj1qhAJw\", \"v\": \"US\"}"
    },
    "birthdate": "{\"s\": \"WpxJrFuX8uSi2p4ht09jvw\", \"v\": \"1940-01-01\"}"
  }
}
</pre><a href="#section-b.1-6" class="pilcrow">¶</a>
</div>
</div>
<p id="section-b.1-7">The verifier would learn this information via the SD-JWT-R:<a href="#section-b.1-7" class="pilcrow">¶</a></p>
<div id="example-simple_structured_some_blinded-sd_jwt_release_payload">
<div id="section-b.1-8">
<pre class="sourcecode lang-json">{
  "nonce": "XZOUco1u_gEPknxS78sWWg",
  "aud": "https://example.com/verifier",
  "sd_release": {
    "given_name": "{\"s\": \"6Ij7tM-a5iVPGboS5tmvVA\", \"v\": \"John\"}",
    "family_name": "{\"s\": \"Qg_O64zqAxe412a108iroA\", \"v\": \"Doe\"}",
    "birthdate": "{\"s\": \"WpxJrFuX8uSi2p4ht09jvw\", \"v\": \"1940-01-01\"}",
    "address": {
      "region": "{\"s\": \"M0Jb57t41ubrkSuyrDT3xA\", \"v\": \"Anystate\"}",
      "country": "{\"s\": \"eK5o5pHfgupPpltj1qhAJw\", \"v\": \"US\"}"
    },
    "5a2W0_NrlEZzfqmk_7Pq-w": "{\"s\": \"5bPs1IquZNa0hkaFzzzZNw\", \"v\": \"23\", \"n\": \"secret_club_membership_no\"}"
  }
}
</pre><a href="#section-b.1-8" class="pilcrow">¶</a>
</div>
</div>
<p id="section-b.1-9">The verifier would decode the data as follows:<a href="#section-b.1-9" class="pilcrow">¶</a></p>
<div id="example-simple_structured_some_blinded-verified_contents">
<div id="section-b.1-10">
<pre class="sourcecode lang-json">{
  "given_name": "John",
  "family_name": "Doe",
  "birthdate": "1940-01-01",
  "address": {
    "region": "Anystate",
    "country": "US"
  },
  "secret_club_membership_no": "23"
}
</pre><a href="#section-b.1-10" class="pilcrow">¶</a>
</div>
</div>
</section>
</div>
<div id="example-6-all-claim-names-blinded">
<section id="section-b.2">
        <h2 id="name-example-6-all-claim-names-b">
<a href="#section-b.2" class="section-number selfRef">B.2. </a><a href="#name-example-6-all-claim-names-b" class="section-name selfRef">Example 6: All Claim Names Blinded</a>
        </h2>
<p id="section-b.2-1">In this example, all claim names are blinded. The following user data is used:<a href="#section-b.2-1" class="pilcrow">¶</a></p>
<div id="example-simple_structured_all_blinded-user_claims">
<div id="section-b.2-2">
<pre class="sourcecode lang-json">{
  "sub": "6c5c0a49-b589-431d-bae7-219122a9ec2c",
  "given_name": "John",
  "family_name": "Doe",
  "email": "johndoe@example.com",
  "phone_number": "+1-202-555-0101",
  "secret_club_membership_no": "23",
  "address": {
    "street_address": "123 Main St",
    "locality": "Anytown",
    "region": "Anystate",
    "country": "US"
  },
  "birthdate": "1940-01-01"
}
</pre><a href="#section-b.2-2" class="pilcrow">¶</a>
</div>
</div>
<p id="section-b.2-3">The resulting SD-JWT payload:<a href="#section-b.2-3" class="pilcrow">¶</a></p>
<div id="example-simple_structured_all_blinded-sd_jwt_payload">
<div id="section-b.2-4">
<pre class="sourcecode lang-json">{
  "iss": "https://example.com/issuer",
  "cnf": {
    "jwk": {
      "kty": "RSA",
      "n": "pm4bOHBg-oYhAyPWzR56AWX3rUIXp11_ICDkGgS6W3ZWLts-hzwI3x65659kg4hVo9dbGoCJE3ZGF_eaetE30UhBUEgpGwrDrQiJ9zqprmcFfr3qvvkGjtth8Zgl1eM2bJcOwE7PCBHWTKWYs152R7g6Jg2OVph-a8rq-q79MhKG5QoW_mTz10QT_6H4c7PjWG1fjh8hpWNnbP_pv6d1zSwZfc5fl6yVRL0DV0V3lGHKe2Wqf_eNGjBrBLVklDTk8-stX_MWLcR-EGmXAOv0UBWitS_dXJKJu-vXJyw14nHSGuxTIK2hx1pttMft9CsvqimXKeDTU14qQL1eE7ihcw",
      "e": "AQAB"
    }
  },
  "iat": 1516239022,
  "exp": 1516247022,
  "sd_hash_alg": "sha-256",
  "sd_digests": {
    "eluV5Og3gSNII8EYnsxA_A": "bvPLqohL5ROmk2UsuNffH8C1wx9o-ipm-G4SkUwrpAE",
    "eI8ZWm9QnKPpNPeNenHdhQ": "pCtjs0hC2Klhsnpe7BIqnGAsXlyXXC-lAEgX6isoYVM",
    "AJx-095VPrpTtN4QMOqROA": "HS1Ht-bTrXsSTw9JdcHIbTFDkEI_IY52_cmzUgxWZ0k",
    "G02NSrQfjFXQ7Io09syajA": "M2YQ_j8OPPBK3ZLhPPP6_AdSa2-rug2urYjgk_ML_QM",
    "nPuoQnkRFq3BIeAm7AnXFA": "-Brzrp2cs-8nLs7rQI89YJ76s3PrbVe3n_5hlYCy1cE",
    "5a2W0_NrlEZzfqmk_7Pq-w": "gc8VzGTImYRXzP6j7q5RomXt2C_wtsOJ3hAHJdTuEIY",
    "address": {
      "HbQ4X8srVW3QDxnIJdqyOA": "39o5dKobVi8c0dLpg4sjd7zW18UONRra0ht9mgu4hec",
      "kx5kF17V-x0JmwUx9vgvtw": "wqueD5ABJ3bTyGSckOMpzI7YUvcCO2l-40vi6JMYsYY",
      "OBKlTVlvLg-AdwqYGbP8ZA": "S11dsdFN97YtrA2o3yZ0eBbf1zn-izejORU-fyMtynI",
      "DsmtKNgpV4dAHpjrcaosAw": "-0XEQHSNzMu244QaOpLmPD3JkdZN8SrqbEQ4VDufu9A"
    },
    "j7ADdb0UVb0Li0ciPcP0ew": "X_v1hrkQIH_0LBM8TncMMTBzYN9UJc8FmJRda7yfY8g"
  }
}
</pre><a href="#section-b.2-4" class="pilcrow">¶</a>
</div>
</div>
<p id="section-b.2-5">The SVC:<a href="#section-b.2-5" class="pilcrow">¶</a></p>
<div id="example-simple_structured_all_blinded-svc_payload">
<div id="section-b.2-6">
<pre class="sourcecode lang-json">{
  "sd_release": {
    "eluV5Og3gSNII8EYnsxA_A": "{\"s\": \"2GLC42sKQveCfGfryNRN9w\", \"v\": \"6c5c0a49-b589-431d-bae7-219122a9ec2c\", \"n\": \"sub\"}",
    "eI8ZWm9QnKPpNPeNenHdhQ": "{\"s\": \"6Ij7tM-a5iVPGboS5tmvVA\", \"v\": \"John\", \"n\": \"given_name\"}",
    "AJx-095VPrpTtN4QMOqROA": "{\"s\": \"Qg_O64zqAxe412a108iroA\", \"v\": \"Doe\", \"n\": \"family_name\"}",
    "G02NSrQfjFXQ7Io09syajA": "{\"s\": \"Pc33JM2LchcU_lHggv_ufQ\", \"v\": \"johndoe@example.com\", \"n\": \"email\"}",
    "nPuoQnkRFq3BIeAm7AnXFA": "{\"s\": \"lklxF5jMYlGTPUovMNIvCA\", \"v\": \"+1-202-555-0101\", \"n\": \"phone_number\"}",
    "5a2W0_NrlEZzfqmk_7Pq-w": "{\"s\": \"5bPs1IquZNa0hkaFzzzZNw\", \"v\": \"23\", \"n\": \"secret_club_membership_no\"}",
    "address": {
      "HbQ4X8srVW3QDxnIJdqyOA": "{\"s\": \"y1sVU5wdfJahVdgwPgS7RQ\", \"v\": \"123 Main St\", \"n\": \"street_address\"}",
      "kx5kF17V-x0JmwUx9vgvtw": "{\"s\": \"C9GSoujviJquEgYfojCb1A\", \"v\": \"Anytown\", \"n\": \"locality\"}",
      "OBKlTVlvLg-AdwqYGbP8ZA": "{\"s\": \"H3o1uswP760Fi2yeGdVCEQ\", \"v\": \"Anystate\", \"n\": \"region\"}",
      "DsmtKNgpV4dAHpjrcaosAw": "{\"s\": \"M0Jb57t41ubrkSuyrDT3xA\", \"v\": \"US\", \"n\": \"country\"}"
    },
    "j7ADdb0UVb0Li0ciPcP0ew": "{\"s\": \"eK5o5pHfgupPpltj1qhAJw\", \"v\": \"1940-01-01\", \"n\": \"birthdate\"}"
  }
}
</pre><a href="#section-b.2-6" class="pilcrow">¶</a>
</div>
</div>
<p id="section-b.2-7">Here, the holder decided only to release a subset of the claims to the verifier:<a href="#section-b.2-7" class="pilcrow">¶</a></p>
<div id="example-simple_structured_all_blinded-sd_jwt_release_payload">
<div id="section-b.2-8">
<pre class="sourcecode lang-json">{
  "nonce": "XZOUco1u_gEPknxS78sWWg",
  "aud": "https://example.com/verifier",
  "sd_release": {
    "eI8ZWm9QnKPpNPeNenHdhQ": "{\"s\": \"6Ij7tM-a5iVPGboS5tmvVA\", \"v\": \"John\", \"n\": \"given_name\"}",
    "AJx-095VPrpTtN4QMOqROA": "{\"s\": \"Qg_O64zqAxe412a108iroA\", \"v\": \"Doe\", \"n\": \"family_name\"}",
    "j7ADdb0UVb0Li0ciPcP0ew": "{\"s\": \"eK5o5pHfgupPpltj1qhAJw\", \"v\": \"1940-01-01\", \"n\": \"birthdate\"}",
    "address": {
      "OBKlTVlvLg-AdwqYGbP8ZA": "{\"s\": \"H3o1uswP760Fi2yeGdVCEQ\", \"v\": \"Anystate\", \"n\": \"region\"}",
      "DsmtKNgpV4dAHpjrcaosAw": "{\"s\": \"M0Jb57t41ubrkSuyrDT3xA\", \"v\": \"US\", \"n\": \"country\"}"
    }
  }
}
</pre><a href="#section-b.2-8" class="pilcrow">¶</a>
</div>
</div>
<p id="section-b.2-9">The verifier would decode the SD-JWT-R and SD-JWT as follows:<a href="#section-b.2-9" class="pilcrow">¶</a></p>
<div id="example-simple_structured_all_blinded-verified_contents">
<div id="section-b.2-10">
<pre class="sourcecode lang-json">{
  "given_name": "John",
  "family_name": "Doe",
  "birthdate": "1940-01-01",
  "address": {
    "region": "Anystate",
    "country": "US"
  }
}
</pre><a href="#section-b.2-10" class="pilcrow">¶</a>
</div>
</div>
</section>
</div>
</section>
</div>
<div id="document-history">
<section id="section-appendix.c">
      <h2 id="name-document-history">
<a href="#section-appendix.c" class="section-number selfRef">Appendix C. </a><a href="#name-document-history" class="section-name selfRef">Document History</a>
      </h2>
<p id="section-appendix.c-1">[[ To be removed from the final specification ]]<a href="#section-appendix.c-1" class="pilcrow">¶</a></p>
<p id="section-appendix.c-2">-01<a href="#section-appendix.c-2" class="pilcrow">¶</a></p>
<ul>
<li id="section-appendix.c-3.1">
          <p id="section-appendix.c-3.1.1">clarified relationship between <code>sd_release</code> in the Release and SD-JWT<a href="#section-appendix.c-3.1.1" class="pilcrow">¶</a></p>
</li>
<li id="section-appendix.c-3.2">
          <p id="section-appendix.c-3.2.1">updated examples<a href="#section-appendix.c-3.2.1" class="pilcrow">¶</a></p>
</li>
<li id="section-appendix.c-3.3">
          <p id="section-appendix.c-3.3.1">clarifications<a href="#section-appendix.c-3.3.1" class="pilcrow">¶</a></p>
</li>
<li id="section-appendix.c-3.4">
          <p id="section-appendix.c-3.4.1">fix <code>cnf</code> structure in examples<a href="#section-appendix.c-3.4.1" class="pilcrow">¶</a></p>
</li>
</ul>
<p id="section-appendix.c-4">-00<a href="#section-appendix.c-4" class="pilcrow">¶</a></p>
<ul>
<li id="section-appendix.c-5.1">
          <p id="section-appendix.c-5.1.1">Upload as draft-ietf-oauth-selective-disclosure-jwt-00<a href="#section-appendix.c-5.1.1" class="pilcrow">¶</a></p>
</li>
</ul>
<p id="section-appendix.c-6">[[ pre Working Group Adoption: ]]<a href="#section-appendix.c-6" class="pilcrow">¶</a></p>
<p id="section-appendix.c-7">-02<a href="#section-appendix.c-7" class="pilcrow">¶</a></p>
<ul>
<li id="section-appendix.c-8.1">
          <p id="section-appendix.c-8.1.1">Added acknowledgements<a href="#section-appendix.c-8.1.1" class="pilcrow">¶</a></p>
</li>
<li id="section-appendix.c-8.2">
          <p id="section-appendix.c-8.2.1">Improved Security Considerations<a href="#section-appendix.c-8.2.1" class="pilcrow">¶</a></p>
</li>
<li id="section-appendix.c-8.3">
          <p id="section-appendix.c-8.3.1">Stressed uniqueness requirements for salts<a href="#section-appendix.c-8.3.1" class="pilcrow">¶</a></p>
</li>
<li id="section-appendix.c-8.4">
          <p id="section-appendix.c-8.4.1">Python reference implementation clean-up and refactoring<a href="#section-appendix.c-8.4.1" class="pilcrow">¶</a></p>
</li>
<li id="section-appendix.c-8.5">
          <p id="section-appendix.c-8.5.1">hash<em>alg renamed to sd</em>hash_alg<a href="#section-appendix.c-8.5.1" class="pilcrow">¶</a></p>
</li>
</ul>
<p id="section-appendix.c-9">-01<a href="#section-appendix.c-9" class="pilcrow">¶</a></p>
<ul>
<li id="section-appendix.c-10.1">
          <p id="section-appendix.c-10.1.1">Editorial fixes<a href="#section-appendix.c-10.1.1" class="pilcrow">¶</a></p>
</li>
<li id="section-appendix.c-10.2">
          <p id="section-appendix.c-10.2.1">Added <code>hash_alg</code> claim<a href="#section-appendix.c-10.2.1" class="pilcrow">¶</a></p>
</li>
<li id="section-appendix.c-10.3">
          <p id="section-appendix.c-10.3.1">Renamed <code>_sd</code> to <code>sd_digests</code> and <code>sd_release</code><a href="#section-appendix.c-10.3.1" class="pilcrow">¶</a></p>
</li>
<li id="section-appendix.c-10.4">
          <p id="section-appendix.c-10.4.1">Added descriptions on holder binding - more work to do<a href="#section-appendix.c-10.4.1" class="pilcrow">¶</a></p>
</li>
<li id="section-appendix.c-10.5">
          <p id="section-appendix.c-10.5.1">Clarify that signing the SD-JWT is mandatory<a href="#section-appendix.c-10.5.1" class="pilcrow">¶</a></p>
</li>
</ul>
<p id="section-appendix.c-11">-00<a href="#section-appendix.c-11" class="pilcrow">¶</a></p>
<ul>
<li id="section-appendix.c-12.1">
          <p id="section-appendix.c-12.1.1">Renamed to SD-JWT (focus on JWT instead of JWS since signature is optional)<a href="#section-appendix.c-12.1.1" class="pilcrow">¶</a></p>
</li>
<li id="section-appendix.c-12.2">
          <p id="section-appendix.c-12.2.1">Make holder binding optional<a href="#section-appendix.c-12.2.1" class="pilcrow">¶</a></p>
</li>
<li id="section-appendix.c-12.3">
          <p id="section-appendix.c-12.3.1">Rename proof to release, since when there is no signature, the term "proof" can be misleading<a href="#section-appendix.c-12.3.1" class="pilcrow">¶</a></p>
</li>
<li id="section-appendix.c-12.4">
          <p id="section-appendix.c-12.4.1">Improved the structure of the description<a href="#section-appendix.c-12.4.1" class="pilcrow">¶</a></p>
</li>
<li id="section-appendix.c-12.5">
          <p id="section-appendix.c-12.5.1">Described verification steps<a href="#section-appendix.c-12.5.1" class="pilcrow">¶</a></p>
</li>
<li id="section-appendix.c-12.6">
          <p id="section-appendix.c-12.6.1">All examples generated from python demo implementation<a href="#section-appendix.c-12.6.1" class="pilcrow">¶</a></p>
</li>
<li id="section-appendix.c-12.7">
          <p id="section-appendix.c-12.7.1">Examples for structured objects<a href="#section-appendix.c-12.7.1" class="pilcrow">¶</a></p>
</li>
</ul>
</section>
</div>
<div id="authors-addresses">
<section id="section-appendix.d">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Daniel Fett</span></div>
<div dir="auto" class="left"><span class="org">yes.com</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:mail@danielfett.de" class="email">mail@danielfett.de</a>
</div>
<div class="url">
<span>URI:</span>
<a href="https://danielfett.de/" class="url">https://danielfett.de/</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Kristina Yasuda</span></div>
<div dir="auto" class="left"><span class="org">Microsoft</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:Kristina.Yasuda@microsoft.com" class="email">Kristina.Yasuda@microsoft.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
